{"version":3,"sources":["index.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","global","factory","define","amd","Immutable","this","createClass","ctor","superClass","prototype","Object","create","constructor","Iterable","value","isIterable","Seq","KeyedIterable","isKeyed","KeyedSeq","IndexedIterable","isIndexed","IndexedSeq","SetIterable","isAssociative","SetSeq","maybeIterable","IS_ITERABLE_SENTINEL","maybeKeyed","IS_KEYED_SENTINEL","maybeIndexed","IS_INDEXED_SENTINEL","maybeAssociative","isOrdered","maybeOrdered","IS_ORDERED_SENTINEL","MakeRef","ref","SetRef","OwnerID","arrCopy","arr","offset","len","Math","max","newArr","Array","ii","ensureSize","iter","undefined","size","__iterate","returnTrue","wrapIndex","index","uint32Index","NaN","wholeSlice","begin","end","resolveBegin","resolveIndex","resolveEnd","defaultIndex","min","Iterator","next","iteratorValue","type","k","v","iteratorResult","done","iteratorDone","hasIterator","getIteratorFn","isIterator","maybeIterator","getIterator","iterable","iteratorFn","REAL_ITERATOR_SYMBOL","FAUX_ITERATOR_SYMBOL","isArrayLike","emptySequence","toSeq","seqFromValue","toKeyedSeq","fromEntrySeq","keyedSeqFromValue","entrySeq","toIndexedSeq","indexedSeqFromValue","toSetSeq","ArraySeq","array","_array","ObjectSeq","object","keys","_object","_keys","IterableSeq","_iterable","IteratorSeq","iterator","_iterator","_iteratorCache","isSeq","maybeSeq","IS_SEQ_SENTINEL","EMPTY_SEQ","seq","isArray","TypeError","maybeIndexedSeqFromValue","seqIterate","fn","reverse","useKeys","cache","_cache","maxIndex","entry","__iterateUncached","seqIterator","__iteratorUncached","fromJS","json","converter","fromJSWith","","fromJSDefault","key","parentJSON","map","isPlainObj","toList","toMap","is","valueA","valueB","valueOf","equals","deepEqual","b","__hash","notAssociative","entries","every","flipped","cacheResult","_","allEqual","bSize","has","get","NOT_SET","Repeat","times","_value","Infinity","EMPTY_REPEAT","invariant","condition","error","Range","start","step","abs","_start","_end","_step","ceil","EMPTY_RANGE","Collection","KeyedCollection","IndexedCollection","SetCollection","smi","i32","hash","h","STRING_HASH_CACHE_MIN_STRLEN","cachedHashString","hashString","hashCode","hashJSObj","toString","string","stringHashCache","STRING_HASH_CACHE_SIZE","STRING_HASH_CACHE_MAX_SIZE","charCodeAt","obj","usingWeakMap","weakMap","UID_HASH_KEY","canDefineProperty","propertyIsEnumerable","getIENodeHash","objHashUID","set","isExtensible","defineProperty","enumerable","configurable","writable","apply","arguments","nodeType","node","uniqueID","documentElement","assertNotInfinite","Map","emptyMap","isMap","withMutations","forEach","maybeMap","IS_MAP_SENTINEL","ArrayMapNode","ownerID","BitmapIndexedNode","bitmap","nodes","HashArrayMapNode","count","HashCollisionNode","keyHash","ValueNode","MapIterator","_type","_reverse","_stack","_root","mapIteratorFrame","mapIteratorValue","prev","__prev","makeMap","root","MapPrototype","__ownerID","__altered","EMPTY_MAP","updateMap","newRoot","newSize","didChangeSize","CHANGE_LENGTH","didAlter","DID_ALTER","updateNode","shift","update","isLeafNode","mergeIntoNode","newNode","idx1","MASK","idx2","SHIFT","createNodes","packNodes","excluding","packedII","packedNodes","bit","expandNodes","including","expandedNodes","SIZE","mergeIntoMapWith","merger","iterables","iters","push","mergeIntoCollectionWith","deepMerger","existing","mergeDeep","deepMergerWith","mergeDeepWith","nextValue","collection","filter","x","mergeIntoMap","updateInDeepMap","keyPathIter","notSetValue","updater","isNotSet","existingValue","newValue","nextExisting","nextUpdated","remove","popCount","setIn","idx","val","canEdit","newArray","spliceIn","newLen","after","spliceOut","pop","List","empty","emptyList","isList","makeList","VNode","toArray","list","setSize","maybeList","IS_LIST_SENTINEL","iterateList","iterateNodeOrLeaf","level","iterateLeaf","iterateNode","tailPos","tail","from","left","to","right","DONE","values","_origin","_capacity","getTailOffset","_tail","_level","origin","capacity","ListPrototype","EMPTY_LIST","updateList","setListBounds","newTail","updateVNode","nodeHas","lowerNode","newLowerNode","editableVNode","slice","listNodeFor","rawIndex","owner","oldOrigin","oldCapacity","newOrigin","newCapacity","clear","newLevel","offsetShift","oldTailOffset","newTailOffset","oldTail","removeAfter","removeBefore","beginIndex","mergeIntoListWith","maxSize","OrderedMap","emptyOrderedMap","isOrderedMap","maybeOrderedMap","makeOrderedMap","omap","_map","_list","EMPTY_ORDERED_MAP","updateOrderedMap","newMap","newList","flip","ToKeyedSequence","indexed","_iter","_useKeys","ToIndexedSequence","ToSetSequence","FromEntriesSequence","flipFactory","flipSequence","makeSequence","reversedSequence","includes","cacheResultThrough","this$0","ITERATE_ENTRIES","__iterator","ITERATE_VALUES","ITERATE_KEYS","mapFactory","mapper","context","mappedSequence","c","reverseFactory","filterFactory","predicate","filterSequence","iterations","countByFactory","grouper","groups","asMutable","asImmutable","groupByFactory","isKeyedIter","coerce","iterableClass","reify","sliceFactory","originalSize","resolvedBegin","resolvedEnd","sliceSize","resolvedSize","sliceSeq","skipped","isSkipping","takeWhileFactory","takeSequence","iterating","skipWhileFactory","skipSequence","skipping","concatFactory","isKeyedIterable","concat","singleton","concatSeq","flatten","reduce","sum","flattenFactory","depth","flatSequence","flatDeep","currentDepth","stopped","stack","flatMapFactory","interposeFactory","separator","interposedSequence","sortFactory","comparator","defaultComparator","sort","maxFactory","maxCompare","comp","zipWithFactory","keyIter","zipper","zipSequence","iterators","isDone","steps","some","validateEntry","resolveSize","forceIterator","keyPath","Record","defaultValues","name","hasInitialized","RecordType","setProps","RecordTypePrototype","_name","_defaultValues","RecordPrototype","makeRecord","likeRecord","record","getPrototypeOf","recordName","names","setProp","bind","Set","emptySet","isSet","add","maybeSet","IS_SET_SENTINEL","updateSet","__empty","__make","makeSet","SetPrototype","EMPTY_SET","OrderedSet","emptyOrderedSet","isOrderedSet","maybeOrderedSet","makeOrderedSet","OrderedSetPrototype","EMPTY_ORDERED_SET","Stack","emptyStack","isStack","unshiftAll","maybeStack","IS_STACK_SENTINEL","makeStack","head","StackPrototype","_head","EMPTY_STACK","mixin","methods","keyCopier","getOwnPropertySymbols","keyMapper","entryMapper","not","neg","quoteString","JSON","stringify","String","defaultZipper","defaultNegComparator","hashIterable","ordered","keyed","hashMerge","murmurHashOfSize","imul","SLICE$0","Keyed","Indexed","DELETE","Symbol","ITERATOR_SYMBOL","KEYS","VALUES","ENTRIES","inspect","toSource","of","__toString","hasOwnProperty","searchValue","indexOf","lastIndexOf","other","possibleIndex","floor","offsetValue","d","WeakMap","keyValues","updateIn","deleteIn","updatedValue","merge","mergeWith","mergeIn","m","mergeDeepIn","sortBy","mutable","wasAltered","__ensureOwner","iterate","removeIn","removed","exists","MAX_ARRAY_MAP_SIZE","isEditable","newEntries","keyHashFrag","MAX_BITMAP_INDEXED_SIZE","newBitmap","newNodes","newCount","MIN_HASH_ARRAY_MAP_SIZE","keyMatch","subNode","splice","insert","oldSize","unshift","originIndex","newChild","removingFirst","oldChild","editable","sizeIndex","valueSeq","indexedIterable","defaultVal","_empty","fromKeys","keySeq","union","intersect","originalSet","subtract","peek","pushAll","toJS","__toJS","toJSON","toObject","toOrderedMap","toOrderedSet","toSet","toStack","__toStringMapper","join","returnValue","find","findEntry","sideEffect","joined","isFirst","reducer","initialReduction","reduction","useFirst","reduceRight","reversed","butLast","isEmpty","countBy","entriesSequence","filterNot","found","findKey","findLast","findLastEntry","findLastKey","first","flatMap","searchKey","getIn","searchKeyPath","nested","groupBy","hasIn","isSubset","isSuperset","keyOf","last","lastKeyOf","maxBy","minBy","rest","skip","amount","skipLast","skipWhile","skipUntil","take","takeLast","takeWhile","takeUntil","IterablePrototype","chain","contains","mapEntries","mapKeys","KeyedIterablePrototype","findIndex","removeNum","numArgs","spliced","findLastIndex","interpose","interleave","zipped","interleaved","zip","zipWith","2","__esModule","xSpeed","ySpeed","immutable","3","y","width","height","4","fill","stroke","strokeWidth","shape","5","__extends","__","p","MetaComponent","_super","id","Engine","mkEntity","entity","newId","newEntity","Number","upEntity","rmEntity","pushState","state","popState","run","event","runSystem","system","runIterator","filters","runIteratorOn","initial","entities","6","normalizeKey","ev","keyCode","Input","stage","cb","setAttribute","addEventListener","repeat","Event","EventType","KEY_DOWN","which","KEY_UP","Keys","UNKNOWN","7","Interval","rate","performance","now","interval","setInterval","dt","err","clearInterval","8","IO","_f","Put","_get","Get","_set","Delay","setTimeout","All","ios","counter","_i","ios_1","io","_this","9","Render","config","getContext","timeout","buffer","document","createElement","stageCtx","bufferCtx","_a","resize","window","ctx","drawImage","scale","style","parseInt","getComputedStyle","smoothing","mozImageSmoothingEnabled","imageSmoothingEnabled","translate","10","io_1","Runtime","console","temp","./io","11","position_component_1","movement_component_1","render_component_1","Path2D","moveTo","arc","PI","meta","position","render","movement","../components/movement-component","../components/position-component","../components/render-component","../poly.d.ts","12","lineTo","13","runtime_1","interval_1","render_1","input_1","shmup_1","getElementById","renderer","./engine/input","./engine/interval","./engine/render","./engine/runtime","./shmup","14","15","Shmup","test_entity_1","shmup","engine_1","engine","background_system_1","render_system_1","tmp","input_system_1","shoot_system_1","movement_system_1","./engine/engine","./entities/test-entity","./systems/background-system","./systems/input-system","./systems/movement-system","./systems/render-system","./systems/shoot-system","16","RenderSystem","fillStyle","strokeStyle","fillRect","beginPath","17","InputSystem","coeff","log","ARROW_LEFT","ARROW_RIGHT","ARROW_UP","ARROW_DOWN","../engine/input","18","MovementSystem","memo","xD","yD","19","save","lineWidth","restore","20","ShootSystem","SPACE","bullet","bullet_entity_1","newEngine_1","engine2","../engine/io","../entities/bullet-entity"],"mappings":"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","file":"index.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/**\n *  Copyright (c) 2014-2015, Facebook, Inc.\n *  All rights reserved.\n *\n *  This source code is licensed under the BSD-style license found in the\n *  LICENSE file in the root directory of this source tree. An additional grant\n *  of patent rights can be found in the PATENTS file in the same directory.\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.Immutable = factory());\n}(this, function () { 'use strict';var SLICE$0 = Array.prototype.slice;\n\n  function createClass(ctor, superClass) {\n    if (superClass) {\n      ctor.prototype = Object.create(superClass.prototype);\n    }\n    ctor.prototype.constructor = ctor;\n  }\n\n  function Iterable(value) {\n      return isIterable(value) ? value : Seq(value);\n    }\n\n\n  createClass(KeyedIterable, Iterable);\n    function KeyedIterable(value) {\n      return isKeyed(value) ? value : KeyedSeq(value);\n    }\n\n\n  createClass(IndexedIterable, Iterable);\n    function IndexedIterable(value) {\n      return isIndexed(value) ? value : IndexedSeq(value);\n    }\n\n\n  createClass(SetIterable, Iterable);\n    function SetIterable(value) {\n      return isIterable(value) && !isAssociative(value) ? value : SetSeq(value);\n    }\n\n\n\n  function isIterable(maybeIterable) {\n    return !!(maybeIterable && maybeIterable[IS_ITERABLE_SENTINEL]);\n  }\n\n  function isKeyed(maybeKeyed) {\n    return !!(maybeKeyed && maybeKeyed[IS_KEYED_SENTINEL]);\n  }\n\n  function isIndexed(maybeIndexed) {\n    return !!(maybeIndexed && maybeIndexed[IS_INDEXED_SENTINEL]);\n  }\n\n  function isAssociative(maybeAssociative) {\n    return isKeyed(maybeAssociative) || isIndexed(maybeAssociative);\n  }\n\n  function isOrdered(maybeOrdered) {\n    return !!(maybeOrdered && maybeOrdered[IS_ORDERED_SENTINEL]);\n  }\n\n  Iterable.isIterable = isIterable;\n  Iterable.isKeyed = isKeyed;\n  Iterable.isIndexed = isIndexed;\n  Iterable.isAssociative = isAssociative;\n  Iterable.isOrdered = isOrdered;\n\n  Iterable.Keyed = KeyedIterable;\n  Iterable.Indexed = IndexedIterable;\n  Iterable.Set = SetIterable;\n\n\n  var IS_ITERABLE_SENTINEL = '@@__IMMUTABLE_ITERABLE__@@';\n  var IS_KEYED_SENTINEL = '@@__IMMUTABLE_KEYED__@@';\n  var IS_INDEXED_SENTINEL = '@@__IMMUTABLE_INDEXED__@@';\n  var IS_ORDERED_SENTINEL = '@@__IMMUTABLE_ORDERED__@@';\n\n  // Used for setting prototype methods that IE8 chokes on.\n  var DELETE = 'delete';\n\n  // Constants describing the size of trie nodes.\n  var SHIFT = 5; // Resulted in best performance after ______?\n  var SIZE = 1 << SHIFT;\n  var MASK = SIZE - 1;\n\n  // A consistent shared value representing \"not set\" which equals nothing other\n  // than itself, and nothing that could be provided externally.\n  var NOT_SET = {};\n\n  // Boolean references, Rough equivalent of `bool &`.\n  var CHANGE_LENGTH = { value: false };\n  var DID_ALTER = { value: false };\n\n  function MakeRef(ref) {\n    ref.value = false;\n    return ref;\n  }\n\n  function SetRef(ref) {\n    ref && (ref.value = true);\n  }\n\n  // A function which returns a value representing an \"owner\" for transient writes\n  // to tries. The return value will only ever equal itself, and will not equal\n  // the return of any subsequent call of this function.\n  function OwnerID() {}\n\n  // http://jsperf.com/copy-array-inline\n  function arrCopy(arr, offset) {\n    offset = offset || 0;\n    var len = Math.max(0, arr.length - offset);\n    var newArr = new Array(len);\n    for (var ii = 0; ii < len; ii++) {\n      newArr[ii] = arr[ii + offset];\n    }\n    return newArr;\n  }\n\n  function ensureSize(iter) {\n    if (iter.size === undefined) {\n      iter.size = iter.__iterate(returnTrue);\n    }\n    return iter.size;\n  }\n\n  function wrapIndex(iter, index) {\n    // This implements \"is array index\" which the ECMAString spec defines as:\n    //\n    //     A String property name P is an array index if and only if\n    //     ToString(ToUint32(P)) is equal to P and ToUint32(P) is not equal\n    //     to 2^321.\n    //\n    // http://www.ecma-international.org/ecma-262/6.0/#sec-array-exotic-objects\n    if (typeof index !== 'number') {\n      var uint32Index = index >>> 0; // N >>> 0 is shorthand for ToUint32\n      if ('' + uint32Index !== index || uint32Index === 4294967295) {\n        return NaN;\n      }\n      index = uint32Index;\n    }\n    return index < 0 ? ensureSize(iter) + index : index;\n  }\n\n  function returnTrue() {\n    return true;\n  }\n\n  function wholeSlice(begin, end, size) {\n    return (begin === 0 || (size !== undefined && begin <= -size)) &&\n      (end === undefined || (size !== undefined && end >= size));\n  }\n\n  function resolveBegin(begin, size) {\n    return resolveIndex(begin, size, 0);\n  }\n\n  function resolveEnd(end, size) {\n    return resolveIndex(end, size, size);\n  }\n\n  function resolveIndex(index, size, defaultIndex) {\n    return index === undefined ?\n      defaultIndex :\n      index < 0 ?\n        Math.max(0, size + index) :\n        size === undefined ?\n          index :\n          Math.min(size, index);\n  }\n\n  /* global Symbol */\n\n  var ITERATE_KEYS = 0;\n  var ITERATE_VALUES = 1;\n  var ITERATE_ENTRIES = 2;\n\n  var REAL_ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\n  var FAUX_ITERATOR_SYMBOL = '@@iterator';\n\n  var ITERATOR_SYMBOL = REAL_ITERATOR_SYMBOL || FAUX_ITERATOR_SYMBOL;\n\n\n  function Iterator(next) {\n      this.next = next;\n    }\n\n    Iterator.prototype.toString = function() {\n      return '[Iterator]';\n    };\n\n\n  Iterator.KEYS = ITERATE_KEYS;\n  Iterator.VALUES = ITERATE_VALUES;\n  Iterator.ENTRIES = ITERATE_ENTRIES;\n\n  Iterator.prototype.inspect =\n  Iterator.prototype.toSource = function () { return this.toString(); }\n  Iterator.prototype[ITERATOR_SYMBOL] = function () {\n    return this;\n  };\n\n\n  function iteratorValue(type, k, v, iteratorResult) {\n    var value = type === 0 ? k : type === 1 ? v : [k, v];\n    iteratorResult ? (iteratorResult.value = value) : (iteratorResult = {\n      value: value, done: false\n    });\n    return iteratorResult;\n  }\n\n  function iteratorDone() {\n    return { value: undefined, done: true };\n  }\n\n  function hasIterator(maybeIterable) {\n    return !!getIteratorFn(maybeIterable);\n  }\n\n  function isIterator(maybeIterator) {\n    return maybeIterator && typeof maybeIterator.next === 'function';\n  }\n\n  function getIterator(iterable) {\n    var iteratorFn = getIteratorFn(iterable);\n    return iteratorFn && iteratorFn.call(iterable);\n  }\n\n  function getIteratorFn(iterable) {\n    var iteratorFn = iterable && (\n      (REAL_ITERATOR_SYMBOL && iterable[REAL_ITERATOR_SYMBOL]) ||\n      iterable[FAUX_ITERATOR_SYMBOL]\n    );\n    if (typeof iteratorFn === 'function') {\n      return iteratorFn;\n    }\n  }\n\n  function isArrayLike(value) {\n    return value && typeof value.length === 'number';\n  }\n\n  createClass(Seq, Iterable);\n    function Seq(value) {\n      return value === null || value === undefined ? emptySequence() :\n        isIterable(value) ? value.toSeq() : seqFromValue(value);\n    }\n\n    Seq.of = function(/*...values*/) {\n      return Seq(arguments);\n    };\n\n    Seq.prototype.toSeq = function() {\n      return this;\n    };\n\n    Seq.prototype.toString = function() {\n      return this.__toString('Seq {', '}');\n    };\n\n    Seq.prototype.cacheResult = function() {\n      if (!this._cache && this.__iterateUncached) {\n        this._cache = this.entrySeq().toArray();\n        this.size = this._cache.length;\n      }\n      return this;\n    };\n\n    // abstract __iterateUncached(fn, reverse)\n\n    Seq.prototype.__iterate = function(fn, reverse) {\n      return seqIterate(this, fn, reverse, true);\n    };\n\n    // abstract __iteratorUncached(type, reverse)\n\n    Seq.prototype.__iterator = function(type, reverse) {\n      return seqIterator(this, type, reverse, true);\n    };\n\n\n\n  createClass(KeyedSeq, Seq);\n    function KeyedSeq(value) {\n      return value === null || value === undefined ?\n        emptySequence().toKeyedSeq() :\n        isIterable(value) ?\n          (isKeyed(value) ? value.toSeq() : value.fromEntrySeq()) :\n          keyedSeqFromValue(value);\n    }\n\n    KeyedSeq.prototype.toKeyedSeq = function() {\n      return this;\n    };\n\n\n\n  createClass(IndexedSeq, Seq);\n    function IndexedSeq(value) {\n      return value === null || value === undefined ? emptySequence() :\n        !isIterable(value) ? indexedSeqFromValue(value) :\n        isKeyed(value) ? value.entrySeq() : value.toIndexedSeq();\n    }\n\n    IndexedSeq.of = function(/*...values*/) {\n      return IndexedSeq(arguments);\n    };\n\n    IndexedSeq.prototype.toIndexedSeq = function() {\n      return this;\n    };\n\n    IndexedSeq.prototype.toString = function() {\n      return this.__toString('Seq [', ']');\n    };\n\n    IndexedSeq.prototype.__iterate = function(fn, reverse) {\n      return seqIterate(this, fn, reverse, false);\n    };\n\n    IndexedSeq.prototype.__iterator = function(type, reverse) {\n      return seqIterator(this, type, reverse, false);\n    };\n\n\n\n  createClass(SetSeq, Seq);\n    function SetSeq(value) {\n      return (\n        value === null || value === undefined ? emptySequence() :\n        !isIterable(value) ? indexedSeqFromValue(value) :\n        isKeyed(value) ? value.entrySeq() : value\n      ).toSetSeq();\n    }\n\n    SetSeq.of = function(/*...values*/) {\n      return SetSeq(arguments);\n    };\n\n    SetSeq.prototype.toSetSeq = function() {\n      return this;\n    };\n\n\n\n  Seq.isSeq = isSeq;\n  Seq.Keyed = KeyedSeq;\n  Seq.Set = SetSeq;\n  Seq.Indexed = IndexedSeq;\n\n  var IS_SEQ_SENTINEL = '@@__IMMUTABLE_SEQ__@@';\n\n  Seq.prototype[IS_SEQ_SENTINEL] = true;\n\n\n\n  createClass(ArraySeq, IndexedSeq);\n    function ArraySeq(array) {\n      this._array = array;\n      this.size = array.length;\n    }\n\n    ArraySeq.prototype.get = function(index, notSetValue) {\n      return this.has(index) ? this._array[wrapIndex(this, index)] : notSetValue;\n    };\n\n    ArraySeq.prototype.__iterate = function(fn, reverse) {\n      var array = this._array;\n      var maxIndex = array.length - 1;\n      for (var ii = 0; ii <= maxIndex; ii++) {\n        if (fn(array[reverse ? maxIndex - ii : ii], ii, this) === false) {\n          return ii + 1;\n        }\n      }\n      return ii;\n    };\n\n    ArraySeq.prototype.__iterator = function(type, reverse) {\n      var array = this._array;\n      var maxIndex = array.length - 1;\n      var ii = 0;\n      return new Iterator(function() \n        {return ii > maxIndex ?\n          iteratorDone() :\n          iteratorValue(type, ii, array[reverse ? maxIndex - ii++ : ii++])}\n      );\n    };\n\n\n\n  createClass(ObjectSeq, KeyedSeq);\n    function ObjectSeq(object) {\n      var keys = Object.keys(object);\n      this._object = object;\n      this._keys = keys;\n      this.size = keys.length;\n    }\n\n    ObjectSeq.prototype.get = function(key, notSetValue) {\n      if (notSetValue !== undefined && !this.has(key)) {\n        return notSetValue;\n      }\n      return this._object[key];\n    };\n\n    ObjectSeq.prototype.has = function(key) {\n      return this._object.hasOwnProperty(key);\n    };\n\n    ObjectSeq.prototype.__iterate = function(fn, reverse) {\n      var object = this._object;\n      var keys = this._keys;\n      var maxIndex = keys.length - 1;\n      for (var ii = 0; ii <= maxIndex; ii++) {\n        var key = keys[reverse ? maxIndex - ii : ii];\n        if (fn(object[key], key, this) === false) {\n          return ii + 1;\n        }\n      }\n      return ii;\n    };\n\n    ObjectSeq.prototype.__iterator = function(type, reverse) {\n      var object = this._object;\n      var keys = this._keys;\n      var maxIndex = keys.length - 1;\n      var ii = 0;\n      return new Iterator(function()  {\n        var key = keys[reverse ? maxIndex - ii : ii];\n        return ii++ > maxIndex ?\n          iteratorDone() :\n          iteratorValue(type, key, object[key]);\n      });\n    };\n\n  ObjectSeq.prototype[IS_ORDERED_SENTINEL] = true;\n\n\n  createClass(IterableSeq, IndexedSeq);\n    function IterableSeq(iterable) {\n      this._iterable = iterable;\n      this.size = iterable.length || iterable.size;\n    }\n\n    IterableSeq.prototype.__iterateUncached = function(fn, reverse) {\n      if (reverse) {\n        return this.cacheResult().__iterate(fn, reverse);\n      }\n      var iterable = this._iterable;\n      var iterator = getIterator(iterable);\n      var iterations = 0;\n      if (isIterator(iterator)) {\n        var step;\n        while (!(step = iterator.next()).done) {\n          if (fn(step.value, iterations++, this) === false) {\n            break;\n          }\n        }\n      }\n      return iterations;\n    };\n\n    IterableSeq.prototype.__iteratorUncached = function(type, reverse) {\n      if (reverse) {\n        return this.cacheResult().__iterator(type, reverse);\n      }\n      var iterable = this._iterable;\n      var iterator = getIterator(iterable);\n      if (!isIterator(iterator)) {\n        return new Iterator(iteratorDone);\n      }\n      var iterations = 0;\n      return new Iterator(function()  {\n        var step = iterator.next();\n        return step.done ? step : iteratorValue(type, iterations++, step.value);\n      });\n    };\n\n\n\n  createClass(IteratorSeq, IndexedSeq);\n    function IteratorSeq(iterator) {\n      this._iterator = iterator;\n      this._iteratorCache = [];\n    }\n\n    IteratorSeq.prototype.__iterateUncached = function(fn, reverse) {\n      if (reverse) {\n        return this.cacheResult().__iterate(fn, reverse);\n      }\n      var iterator = this._iterator;\n      var cache = this._iteratorCache;\n      var iterations = 0;\n      while (iterations < cache.length) {\n        if (fn(cache[iterations], iterations++, this) === false) {\n          return iterations;\n        }\n      }\n      var step;\n      while (!(step = iterator.next()).done) {\n        var val = step.value;\n        cache[iterations] = val;\n        if (fn(val, iterations++, this) === false) {\n          break;\n        }\n      }\n      return iterations;\n    };\n\n    IteratorSeq.prototype.__iteratorUncached = function(type, reverse) {\n      if (reverse) {\n        return this.cacheResult().__iterator(type, reverse);\n      }\n      var iterator = this._iterator;\n      var cache = this._iteratorCache;\n      var iterations = 0;\n      return new Iterator(function()  {\n        if (iterations >= cache.length) {\n          var step = iterator.next();\n          if (step.done) {\n            return step;\n          }\n          cache[iterations] = step.value;\n        }\n        return iteratorValue(type, iterations, cache[iterations++]);\n      });\n    };\n\n\n\n\n  // # pragma Helper functions\n\n  function isSeq(maybeSeq) {\n    return !!(maybeSeq && maybeSeq[IS_SEQ_SENTINEL]);\n  }\n\n  var EMPTY_SEQ;\n\n  function emptySequence() {\n    return EMPTY_SEQ || (EMPTY_SEQ = new ArraySeq([]));\n  }\n\n  function keyedSeqFromValue(value) {\n    var seq =\n      Array.isArray(value) ? new ArraySeq(value).fromEntrySeq() :\n      isIterator(value) ? new IteratorSeq(value).fromEntrySeq() :\n      hasIterator(value) ? new IterableSeq(value).fromEntrySeq() :\n      typeof value === 'object' ? new ObjectSeq(value) :\n      undefined;\n    if (!seq) {\n      throw new TypeError(\n        'Expected Array or iterable object of [k, v] entries, '+\n        'or keyed object: ' + value\n      );\n    }\n    return seq;\n  }\n\n  function indexedSeqFromValue(value) {\n    var seq = maybeIndexedSeqFromValue(value);\n    if (!seq) {\n      throw new TypeError(\n        'Expected Array or iterable object of values: ' + value\n      );\n    }\n    return seq;\n  }\n\n  function seqFromValue(value) {\n    var seq = maybeIndexedSeqFromValue(value) ||\n      (typeof value === 'object' && new ObjectSeq(value));\n    if (!seq) {\n      throw new TypeError(\n        'Expected Array or iterable object of values, or keyed object: ' + value\n      );\n    }\n    return seq;\n  }\n\n  function maybeIndexedSeqFromValue(value) {\n    return (\n      isArrayLike(value) ? new ArraySeq(value) :\n      isIterator(value) ? new IteratorSeq(value) :\n      hasIterator(value) ? new IterableSeq(value) :\n      undefined\n    );\n  }\n\n  function seqIterate(seq, fn, reverse, useKeys) {\n    var cache = seq._cache;\n    if (cache) {\n      var maxIndex = cache.length - 1;\n      for (var ii = 0; ii <= maxIndex; ii++) {\n        var entry = cache[reverse ? maxIndex - ii : ii];\n        if (fn(entry[1], useKeys ? entry[0] : ii, seq) === false) {\n          return ii + 1;\n        }\n      }\n      return ii;\n    }\n    return seq.__iterateUncached(fn, reverse);\n  }\n\n  function seqIterator(seq, type, reverse, useKeys) {\n    var cache = seq._cache;\n    if (cache) {\n      var maxIndex = cache.length - 1;\n      var ii = 0;\n      return new Iterator(function()  {\n        var entry = cache[reverse ? maxIndex - ii : ii];\n        return ii++ > maxIndex ?\n          iteratorDone() :\n          iteratorValue(type, useKeys ? entry[0] : ii - 1, entry[1]);\n      });\n    }\n    return seq.__iteratorUncached(type, reverse);\n  }\n\n  function fromJS(json, converter) {\n    return converter ?\n      fromJSWith(converter, json, '', {'': json}) :\n      fromJSDefault(json);\n  }\n\n  function fromJSWith(converter, json, key, parentJSON) {\n    if (Array.isArray(json)) {\n      return converter.call(parentJSON, key, IndexedSeq(json).map(function(v, k)  {return fromJSWith(converter, v, k, json)}));\n    }\n    if (isPlainObj(json)) {\n      return converter.call(parentJSON, key, KeyedSeq(json).map(function(v, k)  {return fromJSWith(converter, v, k, json)}));\n    }\n    return json;\n  }\n\n  function fromJSDefault(json) {\n    if (Array.isArray(json)) {\n      return IndexedSeq(json).map(fromJSDefault).toList();\n    }\n    if (isPlainObj(json)) {\n      return KeyedSeq(json).map(fromJSDefault).toMap();\n    }\n    return json;\n  }\n\n  function isPlainObj(value) {\n    return value && (value.constructor === Object || value.constructor === undefined);\n  }\n\n  /**\n   * An extension of the \"same-value\" algorithm as [described for use by ES6 Map\n   * and Set](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map#Key_equality)\n   *\n   * NaN is considered the same as NaN, however -0 and 0 are considered the same\n   * value, which is different from the algorithm described by\n   * [`Object.is`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is).\n   *\n   * This is extended further to allow Objects to describe the values they\n   * represent, by way of `valueOf` or `equals` (and `hashCode`).\n   *\n   * Note: because of this extension, the key equality of Immutable.Map and the\n   * value equality of Immutable.Set will differ from ES6 Map and Set.\n   *\n   * ### Defining custom values\n   *\n   * The easiest way to describe the value an object represents is by implementing\n   * `valueOf`. For example, `Date` represents a value by returning a unix\n   * timestamp for `valueOf`:\n   *\n   *     var date1 = new Date(1234567890000); // Fri Feb 13 2009 ...\n   *     var date2 = new Date(1234567890000);\n   *     date1.valueOf(); // 1234567890000\n   *     assert( date1 !== date2 );\n   *     assert( Immutable.is( date1, date2 ) );\n   *\n   * Note: overriding `valueOf` may have other implications if you use this object\n   * where JavaScript expects a primitive, such as implicit string coercion.\n   *\n   * For more complex types, especially collections, implementing `valueOf` may\n   * not be performant. An alternative is to implement `equals` and `hashCode`.\n   *\n   * `equals` takes another object, presumably of similar type, and returns true\n   * if the it is equal. Equality is symmetrical, so the same result should be\n   * returned if this and the argument are flipped.\n   *\n   *     assert( a.equals(b) === b.equals(a) );\n   *\n   * `hashCode` returns a 32bit integer number representing the object which will\n   * be used to determine how to store the value object in a Map or Set. You must\n   * provide both or neither methods, one must not exist without the other.\n   *\n   * Also, an important relationship between these methods must be upheld: if two\n   * values are equal, they *must* return the same hashCode. If the values are not\n   * equal, they might have the same hashCode; this is called a hash collision,\n   * and while undesirable for performance reasons, it is acceptable.\n   *\n   *     if (a.equals(b)) {\n   *       assert( a.hashCode() === b.hashCode() );\n   *     }\n   *\n   * All Immutable collections implement `equals` and `hashCode`.\n   *\n   */\n  function is(valueA, valueB) {\n    if (valueA === valueB || (valueA !== valueA && valueB !== valueB)) {\n      return true;\n    }\n    if (!valueA || !valueB) {\n      return false;\n    }\n    if (typeof valueA.valueOf === 'function' &&\n        typeof valueB.valueOf === 'function') {\n      valueA = valueA.valueOf();\n      valueB = valueB.valueOf();\n      if (valueA === valueB || (valueA !== valueA && valueB !== valueB)) {\n        return true;\n      }\n      if (!valueA || !valueB) {\n        return false;\n      }\n    }\n    if (typeof valueA.equals === 'function' &&\n        typeof valueB.equals === 'function' &&\n        valueA.equals(valueB)) {\n      return true;\n    }\n    return false;\n  }\n\n  function deepEqual(a, b) {\n    if (a === b) {\n      return true;\n    }\n\n    if (\n      !isIterable(b) ||\n      a.size !== undefined && b.size !== undefined && a.size !== b.size ||\n      a.__hash !== undefined && b.__hash !== undefined && a.__hash !== b.__hash ||\n      isKeyed(a) !== isKeyed(b) ||\n      isIndexed(a) !== isIndexed(b) ||\n      isOrdered(a) !== isOrdered(b)\n    ) {\n      return false;\n    }\n\n    if (a.size === 0 && b.size === 0) {\n      return true;\n    }\n\n    var notAssociative = !isAssociative(a);\n\n    if (isOrdered(a)) {\n      var entries = a.entries();\n      return b.every(function(v, k)  {\n        var entry = entries.next().value;\n        return entry && is(entry[1], v) && (notAssociative || is(entry[0], k));\n      }) && entries.next().done;\n    }\n\n    var flipped = false;\n\n    if (a.size === undefined) {\n      if (b.size === undefined) {\n        if (typeof a.cacheResult === 'function') {\n          a.cacheResult();\n        }\n      } else {\n        flipped = true;\n        var _ = a;\n        a = b;\n        b = _;\n      }\n    }\n\n    var allEqual = true;\n    var bSize = b.__iterate(function(v, k)  {\n      if (notAssociative ? !a.has(v) :\n          flipped ? !is(v, a.get(k, NOT_SET)) : !is(a.get(k, NOT_SET), v)) {\n        allEqual = false;\n        return false;\n      }\n    });\n\n    return allEqual && a.size === bSize;\n  }\n\n  createClass(Repeat, IndexedSeq);\n\n    function Repeat(value, times) {\n      if (!(this instanceof Repeat)) {\n        return new Repeat(value, times);\n      }\n      this._value = value;\n      this.size = times === undefined ? Infinity : Math.max(0, times);\n      if (this.size === 0) {\n        if (EMPTY_REPEAT) {\n          return EMPTY_REPEAT;\n        }\n        EMPTY_REPEAT = this;\n      }\n    }\n\n    Repeat.prototype.toString = function() {\n      if (this.size === 0) {\n        return 'Repeat []';\n      }\n      return 'Repeat [ ' + this._value + ' ' + this.size + ' times ]';\n    };\n\n    Repeat.prototype.get = function(index, notSetValue) {\n      return this.has(index) ? this._value : notSetValue;\n    };\n\n    Repeat.prototype.includes = function(searchValue) {\n      return is(this._value, searchValue);\n    };\n\n    Repeat.prototype.slice = function(begin, end) {\n      var size = this.size;\n      return wholeSlice(begin, end, size) ? this :\n        new Repeat(this._value, resolveEnd(end, size) - resolveBegin(begin, size));\n    };\n\n    Repeat.prototype.reverse = function() {\n      return this;\n    };\n\n    Repeat.prototype.indexOf = function(searchValue) {\n      if (is(this._value, searchValue)) {\n        return 0;\n      }\n      return -1;\n    };\n\n    Repeat.prototype.lastIndexOf = function(searchValue) {\n      if (is(this._value, searchValue)) {\n        return this.size;\n      }\n      return -1;\n    };\n\n    Repeat.prototype.__iterate = function(fn, reverse) {\n      for (var ii = 0; ii < this.size; ii++) {\n        if (fn(this._value, ii, this) === false) {\n          return ii + 1;\n        }\n      }\n      return ii;\n    };\n\n    Repeat.prototype.__iterator = function(type, reverse) {var this$0 = this;\n      var ii = 0;\n      return new Iterator(function() \n        {return ii < this$0.size ? iteratorValue(type, ii++, this$0._value) : iteratorDone()}\n      );\n    };\n\n    Repeat.prototype.equals = function(other) {\n      return other instanceof Repeat ?\n        is(this._value, other._value) :\n        deepEqual(other);\n    };\n\n\n  var EMPTY_REPEAT;\n\n  function invariant(condition, error) {\n    if (!condition) throw new Error(error);\n  }\n\n  createClass(Range, IndexedSeq);\n\n    function Range(start, end, step) {\n      if (!(this instanceof Range)) {\n        return new Range(start, end, step);\n      }\n      invariant(step !== 0, 'Cannot step a Range by 0');\n      start = start || 0;\n      if (end === undefined) {\n        end = Infinity;\n      }\n      step = step === undefined ? 1 : Math.abs(step);\n      if (end < start) {\n        step = -step;\n      }\n      this._start = start;\n      this._end = end;\n      this._step = step;\n      this.size = Math.max(0, Math.ceil((end - start) / step - 1) + 1);\n      if (this.size === 0) {\n        if (EMPTY_RANGE) {\n          return EMPTY_RANGE;\n        }\n        EMPTY_RANGE = this;\n      }\n    }\n\n    Range.prototype.toString = function() {\n      if (this.size === 0) {\n        return 'Range []';\n      }\n      return 'Range [ ' +\n        this._start + '...' + this._end +\n        (this._step !== 1 ? ' by ' + this._step : '') +\n      ' ]';\n    };\n\n    Range.prototype.get = function(index, notSetValue) {\n      return this.has(index) ?\n        this._start + wrapIndex(this, index) * this._step :\n        notSetValue;\n    };\n\n    Range.prototype.includes = function(searchValue) {\n      var possibleIndex = (searchValue - this._start) / this._step;\n      return possibleIndex >= 0 &&\n        possibleIndex < this.size &&\n        possibleIndex === Math.floor(possibleIndex);\n    };\n\n    Range.prototype.slice = function(begin, end) {\n      if (wholeSlice(begin, end, this.size)) {\n        return this;\n      }\n      begin = resolveBegin(begin, this.size);\n      end = resolveEnd(end, this.size);\n      if (end <= begin) {\n        return new Range(0, 0);\n      }\n      return new Range(this.get(begin, this._end), this.get(end, this._end), this._step);\n    };\n\n    Range.prototype.indexOf = function(searchValue) {\n      var offsetValue = searchValue - this._start;\n      if (offsetValue % this._step === 0) {\n        var index = offsetValue / this._step;\n        if (index >= 0 && index < this.size) {\n          return index\n        }\n      }\n      return -1;\n    };\n\n    Range.prototype.lastIndexOf = function(searchValue) {\n      return this.indexOf(searchValue);\n    };\n\n    Range.prototype.__iterate = function(fn, reverse) {\n      var maxIndex = this.size - 1;\n      var step = this._step;\n      var value = reverse ? this._start + maxIndex * step : this._start;\n      for (var ii = 0; ii <= maxIndex; ii++) {\n        if (fn(value, ii, this) === false) {\n          return ii + 1;\n        }\n        value += reverse ? -step : step;\n      }\n      return ii;\n    };\n\n    Range.prototype.__iterator = function(type, reverse) {\n      var maxIndex = this.size - 1;\n      var step = this._step;\n      var value = reverse ? this._start + maxIndex * step : this._start;\n      var ii = 0;\n      return new Iterator(function()  {\n        var v = value;\n        value += reverse ? -step : step;\n        return ii > maxIndex ? iteratorDone() : iteratorValue(type, ii++, v);\n      });\n    };\n\n    Range.prototype.equals = function(other) {\n      return other instanceof Range ?\n        this._start === other._start &&\n        this._end === other._end &&\n        this._step === other._step :\n        deepEqual(this, other);\n    };\n\n\n  var EMPTY_RANGE;\n\n  createClass(Collection, Iterable);\n    function Collection() {\n      throw TypeError('Abstract');\n    }\n\n\n  createClass(KeyedCollection, Collection);function KeyedCollection() {}\n\n  createClass(IndexedCollection, Collection);function IndexedCollection() {}\n\n  createClass(SetCollection, Collection);function SetCollection() {}\n\n\n  Collection.Keyed = KeyedCollection;\n  Collection.Indexed = IndexedCollection;\n  Collection.Set = SetCollection;\n\n  var imul =\n    typeof Math.imul === 'function' && Math.imul(0xffffffff, 2) === -2 ?\n    Math.imul :\n    function imul(a, b) {\n      a = a | 0; // int\n      b = b | 0; // int\n      var c = a & 0xffff;\n      var d = b & 0xffff;\n      // Shift by 0 fixes the sign on the high part.\n      return (c * d) + ((((a >>> 16) * d + c * (b >>> 16)) << 16) >>> 0) | 0; // int\n    };\n\n  // v8 has an optimization for storing 31-bit signed numbers.\n  // Values which have either 00 or 11 as the high order bits qualify.\n  // This function drops the highest order bit in a signed number, maintaining\n  // the sign bit.\n  function smi(i32) {\n    return ((i32 >>> 1) & 0x40000000) | (i32 & 0xBFFFFFFF);\n  }\n\n  function hash(o) {\n    if (o === false || o === null || o === undefined) {\n      return 0;\n    }\n    if (typeof o.valueOf === 'function') {\n      o = o.valueOf();\n      if (o === false || o === null || o === undefined) {\n        return 0;\n      }\n    }\n    if (o === true) {\n      return 1;\n    }\n    var type = typeof o;\n    if (type === 'number') {\n      if (o !== o || o === Infinity) {\n        return 0;\n      }\n      var h = o | 0;\n      if (h !== o) {\n        h ^= o * 0xFFFFFFFF;\n      }\n      while (o > 0xFFFFFFFF) {\n        o /= 0xFFFFFFFF;\n        h ^= o;\n      }\n      return smi(h);\n    }\n    if (type === 'string') {\n      return o.length > STRING_HASH_CACHE_MIN_STRLEN ? cachedHashString(o) : hashString(o);\n    }\n    if (typeof o.hashCode === 'function') {\n      return o.hashCode();\n    }\n    if (type === 'object') {\n      return hashJSObj(o);\n    }\n    if (typeof o.toString === 'function') {\n      return hashString(o.toString());\n    }\n    throw new Error('Value type ' + type + ' cannot be hashed.');\n  }\n\n  function cachedHashString(string) {\n    var hash = stringHashCache[string];\n    if (hash === undefined) {\n      hash = hashString(string);\n      if (STRING_HASH_CACHE_SIZE === STRING_HASH_CACHE_MAX_SIZE) {\n        STRING_HASH_CACHE_SIZE = 0;\n        stringHashCache = {};\n      }\n      STRING_HASH_CACHE_SIZE++;\n      stringHashCache[string] = hash;\n    }\n    return hash;\n  }\n\n  // http://jsperf.com/hashing-strings\n  function hashString(string) {\n    // This is the hash from JVM\n    // The hash code for a string is computed as\n    // s[0] * 31 ^ (n - 1) + s[1] * 31 ^ (n - 2) + ... + s[n - 1],\n    // where s[i] is the ith character of the string and n is the length of\n    // the string. We \"mod\" the result to make it between 0 (inclusive) and 2^31\n    // (exclusive) by dropping high bits.\n    var hash = 0;\n    for (var ii = 0; ii < string.length; ii++) {\n      hash = 31 * hash + string.charCodeAt(ii) | 0;\n    }\n    return smi(hash);\n  }\n\n  function hashJSObj(obj) {\n    var hash;\n    if (usingWeakMap) {\n      hash = weakMap.get(obj);\n      if (hash !== undefined) {\n        return hash;\n      }\n    }\n\n    hash = obj[UID_HASH_KEY];\n    if (hash !== undefined) {\n      return hash;\n    }\n\n    if (!canDefineProperty) {\n      hash = obj.propertyIsEnumerable && obj.propertyIsEnumerable[UID_HASH_KEY];\n      if (hash !== undefined) {\n        return hash;\n      }\n\n      hash = getIENodeHash(obj);\n      if (hash !== undefined) {\n        return hash;\n      }\n    }\n\n    hash = ++objHashUID;\n    if (objHashUID & 0x40000000) {\n      objHashUID = 0;\n    }\n\n    if (usingWeakMap) {\n      weakMap.set(obj, hash);\n    } else if (isExtensible !== undefined && isExtensible(obj) === false) {\n      throw new Error('Non-extensible objects are not allowed as keys.');\n    } else if (canDefineProperty) {\n      Object.defineProperty(obj, UID_HASH_KEY, {\n        'enumerable': false,\n        'configurable': false,\n        'writable': false,\n        'value': hash\n      });\n    } else if (obj.propertyIsEnumerable !== undefined &&\n               obj.propertyIsEnumerable === obj.constructor.prototype.propertyIsEnumerable) {\n      // Since we can't define a non-enumerable property on the object\n      // we'll hijack one of the less-used non-enumerable properties to\n      // save our hash on it. Since this is a function it will not show up in\n      // `JSON.stringify` which is what we want.\n      obj.propertyIsEnumerable = function() {\n        return this.constructor.prototype.propertyIsEnumerable.apply(this, arguments);\n      };\n      obj.propertyIsEnumerable[UID_HASH_KEY] = hash;\n    } else if (obj.nodeType !== undefined) {\n      // At this point we couldn't get the IE `uniqueID` to use as a hash\n      // and we couldn't use a non-enumerable property to exploit the\n      // dontEnum bug so we simply add the `UID_HASH_KEY` on the node\n      // itself.\n      obj[UID_HASH_KEY] = hash;\n    } else {\n      throw new Error('Unable to set a non-enumerable property on object.');\n    }\n\n    return hash;\n  }\n\n  // Get references to ES5 object methods.\n  var isExtensible = Object.isExtensible;\n\n  // True if Object.defineProperty works as expected. IE8 fails this test.\n  var canDefineProperty = (function() {\n    try {\n      Object.defineProperty({}, '@', {});\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }());\n\n  // IE has a `uniqueID` property on DOM nodes. We can construct the hash from it\n  // and avoid memory leaks from the IE cloneNode bug.\n  function getIENodeHash(node) {\n    if (node && node.nodeType > 0) {\n      switch (node.nodeType) {\n        case 1: // Element\n          return node.uniqueID;\n        case 9: // Document\n          return node.documentElement && node.documentElement.uniqueID;\n      }\n    }\n  }\n\n  // If possible, use a WeakMap.\n  var usingWeakMap = typeof WeakMap === 'function';\n  var weakMap;\n  if (usingWeakMap) {\n    weakMap = new WeakMap();\n  }\n\n  var objHashUID = 0;\n\n  var UID_HASH_KEY = '__immutablehash__';\n  if (typeof Symbol === 'function') {\n    UID_HASH_KEY = Symbol(UID_HASH_KEY);\n  }\n\n  var STRING_HASH_CACHE_MIN_STRLEN = 16;\n  var STRING_HASH_CACHE_MAX_SIZE = 255;\n  var STRING_HASH_CACHE_SIZE = 0;\n  var stringHashCache = {};\n\n  function assertNotInfinite(size) {\n    invariant(\n      size !== Infinity,\n      'Cannot perform this action with an infinite size.'\n    );\n  }\n\n  createClass(Map, KeyedCollection);\n\n    // @pragma Construction\n\n    function Map(value) {\n      return value === null || value === undefined ? emptyMap() :\n        isMap(value) && !isOrdered(value) ? value :\n        emptyMap().withMutations(function(map ) {\n          var iter = KeyedIterable(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function(v, k)  {return map.set(k, v)});\n        });\n    }\n\n    Map.of = function() {var keyValues = SLICE$0.call(arguments, 0);\n      return emptyMap().withMutations(function(map ) {\n        for (var i = 0; i < keyValues.length; i += 2) {\n          if (i + 1 >= keyValues.length) {\n            throw new Error('Missing value for key: ' + keyValues[i]);\n          }\n          map.set(keyValues[i], keyValues[i + 1]);\n        }\n      });\n    };\n\n    Map.prototype.toString = function() {\n      return this.__toString('Map {', '}');\n    };\n\n    // @pragma Access\n\n    Map.prototype.get = function(k, notSetValue) {\n      return this._root ?\n        this._root.get(0, undefined, k, notSetValue) :\n        notSetValue;\n    };\n\n    // @pragma Modification\n\n    Map.prototype.set = function(k, v) {\n      return updateMap(this, k, v);\n    };\n\n    Map.prototype.setIn = function(keyPath, v) {\n      return this.updateIn(keyPath, NOT_SET, function()  {return v});\n    };\n\n    Map.prototype.remove = function(k) {\n      return updateMap(this, k, NOT_SET);\n    };\n\n    Map.prototype.deleteIn = function(keyPath) {\n      return this.updateIn(keyPath, function()  {return NOT_SET});\n    };\n\n    Map.prototype.update = function(k, notSetValue, updater) {\n      return arguments.length === 1 ?\n        k(this) :\n        this.updateIn([k], notSetValue, updater);\n    };\n\n    Map.prototype.updateIn = function(keyPath, notSetValue, updater) {\n      if (!updater) {\n        updater = notSetValue;\n        notSetValue = undefined;\n      }\n      var updatedValue = updateInDeepMap(\n        this,\n        forceIterator(keyPath),\n        notSetValue,\n        updater\n      );\n      return updatedValue === NOT_SET ? undefined : updatedValue;\n    };\n\n    Map.prototype.clear = function() {\n      if (this.size === 0) {\n        return this;\n      }\n      if (this.__ownerID) {\n        this.size = 0;\n        this._root = null;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return emptyMap();\n    };\n\n    // @pragma Composition\n\n    Map.prototype.merge = function(/*...iters*/) {\n      return mergeIntoMapWith(this, undefined, arguments);\n    };\n\n    Map.prototype.mergeWith = function(merger) {var iters = SLICE$0.call(arguments, 1);\n      return mergeIntoMapWith(this, merger, iters);\n    };\n\n    Map.prototype.mergeIn = function(keyPath) {var iters = SLICE$0.call(arguments, 1);\n      return this.updateIn(\n        keyPath,\n        emptyMap(),\n        function(m ) {return typeof m.merge === 'function' ?\n          m.merge.apply(m, iters) :\n          iters[iters.length - 1]}\n      );\n    };\n\n    Map.prototype.mergeDeep = function(/*...iters*/) {\n      return mergeIntoMapWith(this, deepMerger, arguments);\n    };\n\n    Map.prototype.mergeDeepWith = function(merger) {var iters = SLICE$0.call(arguments, 1);\n      return mergeIntoMapWith(this, deepMergerWith(merger), iters);\n    };\n\n    Map.prototype.mergeDeepIn = function(keyPath) {var iters = SLICE$0.call(arguments, 1);\n      return this.updateIn(\n        keyPath,\n        emptyMap(),\n        function(m ) {return typeof m.mergeDeep === 'function' ?\n          m.mergeDeep.apply(m, iters) :\n          iters[iters.length - 1]}\n      );\n    };\n\n    Map.prototype.sort = function(comparator) {\n      // Late binding\n      return OrderedMap(sortFactory(this, comparator));\n    };\n\n    Map.prototype.sortBy = function(mapper, comparator) {\n      // Late binding\n      return OrderedMap(sortFactory(this, comparator, mapper));\n    };\n\n    // @pragma Mutability\n\n    Map.prototype.withMutations = function(fn) {\n      var mutable = this.asMutable();\n      fn(mutable);\n      return mutable.wasAltered() ? mutable.__ensureOwner(this.__ownerID) : this;\n    };\n\n    Map.prototype.asMutable = function() {\n      return this.__ownerID ? this : this.__ensureOwner(new OwnerID());\n    };\n\n    Map.prototype.asImmutable = function() {\n      return this.__ensureOwner();\n    };\n\n    Map.prototype.wasAltered = function() {\n      return this.__altered;\n    };\n\n    Map.prototype.__iterator = function(type, reverse) {\n      return new MapIterator(this, type, reverse);\n    };\n\n    Map.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      var iterations = 0;\n      this._root && this._root.iterate(function(entry ) {\n        iterations++;\n        return fn(entry[1], entry[0], this$0);\n      }, reverse);\n      return iterations;\n    };\n\n    Map.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        this.__altered = false;\n        return this;\n      }\n      return makeMap(this.size, this._root, ownerID, this.__hash);\n    };\n\n\n  function isMap(maybeMap) {\n    return !!(maybeMap && maybeMap[IS_MAP_SENTINEL]);\n  }\n\n  Map.isMap = isMap;\n\n  var IS_MAP_SENTINEL = '@@__IMMUTABLE_MAP__@@';\n\n  var MapPrototype = Map.prototype;\n  MapPrototype[IS_MAP_SENTINEL] = true;\n  MapPrototype[DELETE] = MapPrototype.remove;\n  MapPrototype.removeIn = MapPrototype.deleteIn;\n\n\n  // #pragma Trie Nodes\n\n\n\n    function ArrayMapNode(ownerID, entries) {\n      this.ownerID = ownerID;\n      this.entries = entries;\n    }\n\n    ArrayMapNode.prototype.get = function(shift, keyHash, key, notSetValue) {\n      var entries = this.entries;\n      for (var ii = 0, len = entries.length; ii < len; ii++) {\n        if (is(key, entries[ii][0])) {\n          return entries[ii][1];\n        }\n      }\n      return notSetValue;\n    };\n\n    ArrayMapNode.prototype.update = function(ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n      var removed = value === NOT_SET;\n\n      var entries = this.entries;\n      var idx = 0;\n      for (var len = entries.length; idx < len; idx++) {\n        if (is(key, entries[idx][0])) {\n          break;\n        }\n      }\n      var exists = idx < len;\n\n      if (exists ? entries[idx][1] === value : removed) {\n        return this;\n      }\n\n      SetRef(didAlter);\n      (removed || !exists) && SetRef(didChangeSize);\n\n      if (removed && entries.length === 1) {\n        return; // undefined\n      }\n\n      if (!exists && !removed && entries.length >= MAX_ARRAY_MAP_SIZE) {\n        return createNodes(ownerID, entries, key, value);\n      }\n\n      var isEditable = ownerID && ownerID === this.ownerID;\n      var newEntries = isEditable ? entries : arrCopy(entries);\n\n      if (exists) {\n        if (removed) {\n          idx === len - 1 ? newEntries.pop() : (newEntries[idx] = newEntries.pop());\n        } else {\n          newEntries[idx] = [key, value];\n        }\n      } else {\n        newEntries.push([key, value]);\n      }\n\n      if (isEditable) {\n        this.entries = newEntries;\n        return this;\n      }\n\n      return new ArrayMapNode(ownerID, newEntries);\n    };\n\n\n\n\n    function BitmapIndexedNode(ownerID, bitmap, nodes) {\n      this.ownerID = ownerID;\n      this.bitmap = bitmap;\n      this.nodes = nodes;\n    }\n\n    BitmapIndexedNode.prototype.get = function(shift, keyHash, key, notSetValue) {\n      if (keyHash === undefined) {\n        keyHash = hash(key);\n      }\n      var bit = (1 << ((shift === 0 ? keyHash : keyHash >>> shift) & MASK));\n      var bitmap = this.bitmap;\n      return (bitmap & bit) === 0 ? notSetValue :\n        this.nodes[popCount(bitmap & (bit - 1))].get(shift + SHIFT, keyHash, key, notSetValue);\n    };\n\n    BitmapIndexedNode.prototype.update = function(ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n      if (keyHash === undefined) {\n        keyHash = hash(key);\n      }\n      var keyHashFrag = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n      var bit = 1 << keyHashFrag;\n      var bitmap = this.bitmap;\n      var exists = (bitmap & bit) !== 0;\n\n      if (!exists && value === NOT_SET) {\n        return this;\n      }\n\n      var idx = popCount(bitmap & (bit - 1));\n      var nodes = this.nodes;\n      var node = exists ? nodes[idx] : undefined;\n      var newNode = updateNode(node, ownerID, shift + SHIFT, keyHash, key, value, didChangeSize, didAlter);\n\n      if (newNode === node) {\n        return this;\n      }\n\n      if (!exists && newNode && nodes.length >= MAX_BITMAP_INDEXED_SIZE) {\n        return expandNodes(ownerID, nodes, bitmap, keyHashFrag, newNode);\n      }\n\n      if (exists && !newNode && nodes.length === 2 && isLeafNode(nodes[idx ^ 1])) {\n        return nodes[idx ^ 1];\n      }\n\n      if (exists && newNode && nodes.length === 1 && isLeafNode(newNode)) {\n        return newNode;\n      }\n\n      var isEditable = ownerID && ownerID === this.ownerID;\n      var newBitmap = exists ? newNode ? bitmap : bitmap ^ bit : bitmap | bit;\n      var newNodes = exists ? newNode ?\n        setIn(nodes, idx, newNode, isEditable) :\n        spliceOut(nodes, idx, isEditable) :\n        spliceIn(nodes, idx, newNode, isEditable);\n\n      if (isEditable) {\n        this.bitmap = newBitmap;\n        this.nodes = newNodes;\n        return this;\n      }\n\n      return new BitmapIndexedNode(ownerID, newBitmap, newNodes);\n    };\n\n\n\n\n    function HashArrayMapNode(ownerID, count, nodes) {\n      this.ownerID = ownerID;\n      this.count = count;\n      this.nodes = nodes;\n    }\n\n    HashArrayMapNode.prototype.get = function(shift, keyHash, key, notSetValue) {\n      if (keyHash === undefined) {\n        keyHash = hash(key);\n      }\n      var idx = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n      var node = this.nodes[idx];\n      return node ? node.get(shift + SHIFT, keyHash, key, notSetValue) : notSetValue;\n    };\n\n    HashArrayMapNode.prototype.update = function(ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n      if (keyHash === undefined) {\n        keyHash = hash(key);\n      }\n      var idx = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n      var removed = value === NOT_SET;\n      var nodes = this.nodes;\n      var node = nodes[idx];\n\n      if (removed && !node) {\n        return this;\n      }\n\n      var newNode = updateNode(node, ownerID, shift + SHIFT, keyHash, key, value, didChangeSize, didAlter);\n      if (newNode === node) {\n        return this;\n      }\n\n      var newCount = this.count;\n      if (!node) {\n        newCount++;\n      } else if (!newNode) {\n        newCount--;\n        if (newCount < MIN_HASH_ARRAY_MAP_SIZE) {\n          return packNodes(ownerID, nodes, newCount, idx);\n        }\n      }\n\n      var isEditable = ownerID && ownerID === this.ownerID;\n      var newNodes = setIn(nodes, idx, newNode, isEditable);\n\n      if (isEditable) {\n        this.count = newCount;\n        this.nodes = newNodes;\n        return this;\n      }\n\n      return new HashArrayMapNode(ownerID, newCount, newNodes);\n    };\n\n\n\n\n    function HashCollisionNode(ownerID, keyHash, entries) {\n      this.ownerID = ownerID;\n      this.keyHash = keyHash;\n      this.entries = entries;\n    }\n\n    HashCollisionNode.prototype.get = function(shift, keyHash, key, notSetValue) {\n      var entries = this.entries;\n      for (var ii = 0, len = entries.length; ii < len; ii++) {\n        if (is(key, entries[ii][0])) {\n          return entries[ii][1];\n        }\n      }\n      return notSetValue;\n    };\n\n    HashCollisionNode.prototype.update = function(ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n      if (keyHash === undefined) {\n        keyHash = hash(key);\n      }\n\n      var removed = value === NOT_SET;\n\n      if (keyHash !== this.keyHash) {\n        if (removed) {\n          return this;\n        }\n        SetRef(didAlter);\n        SetRef(didChangeSize);\n        return mergeIntoNode(this, ownerID, shift, keyHash, [key, value]);\n      }\n\n      var entries = this.entries;\n      var idx = 0;\n      for (var len = entries.length; idx < len; idx++) {\n        if (is(key, entries[idx][0])) {\n          break;\n        }\n      }\n      var exists = idx < len;\n\n      if (exists ? entries[idx][1] === value : removed) {\n        return this;\n      }\n\n      SetRef(didAlter);\n      (removed || !exists) && SetRef(didChangeSize);\n\n      if (removed && len === 2) {\n        return new ValueNode(ownerID, this.keyHash, entries[idx ^ 1]);\n      }\n\n      var isEditable = ownerID && ownerID === this.ownerID;\n      var newEntries = isEditable ? entries : arrCopy(entries);\n\n      if (exists) {\n        if (removed) {\n          idx === len - 1 ? newEntries.pop() : (newEntries[idx] = newEntries.pop());\n        } else {\n          newEntries[idx] = [key, value];\n        }\n      } else {\n        newEntries.push([key, value]);\n      }\n\n      if (isEditable) {\n        this.entries = newEntries;\n        return this;\n      }\n\n      return new HashCollisionNode(ownerID, this.keyHash, newEntries);\n    };\n\n\n\n\n    function ValueNode(ownerID, keyHash, entry) {\n      this.ownerID = ownerID;\n      this.keyHash = keyHash;\n      this.entry = entry;\n    }\n\n    ValueNode.prototype.get = function(shift, keyHash, key, notSetValue) {\n      return is(key, this.entry[0]) ? this.entry[1] : notSetValue;\n    };\n\n    ValueNode.prototype.update = function(ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n      var removed = value === NOT_SET;\n      var keyMatch = is(key, this.entry[0]);\n      if (keyMatch ? value === this.entry[1] : removed) {\n        return this;\n      }\n\n      SetRef(didAlter);\n\n      if (removed) {\n        SetRef(didChangeSize);\n        return; // undefined\n      }\n\n      if (keyMatch) {\n        if (ownerID && ownerID === this.ownerID) {\n          this.entry[1] = value;\n          return this;\n        }\n        return new ValueNode(ownerID, this.keyHash, [key, value]);\n      }\n\n      SetRef(didChangeSize);\n      return mergeIntoNode(this, ownerID, shift, hash(key), [key, value]);\n    };\n\n\n\n  // #pragma Iterators\n\n  ArrayMapNode.prototype.iterate =\n  HashCollisionNode.prototype.iterate = function (fn, reverse) {\n    var entries = this.entries;\n    for (var ii = 0, maxIndex = entries.length - 1; ii <= maxIndex; ii++) {\n      if (fn(entries[reverse ? maxIndex - ii : ii]) === false) {\n        return false;\n      }\n    }\n  }\n\n  BitmapIndexedNode.prototype.iterate =\n  HashArrayMapNode.prototype.iterate = function (fn, reverse) {\n    var nodes = this.nodes;\n    for (var ii = 0, maxIndex = nodes.length - 1; ii <= maxIndex; ii++) {\n      var node = nodes[reverse ? maxIndex - ii : ii];\n      if (node && node.iterate(fn, reverse) === false) {\n        return false;\n      }\n    }\n  }\n\n  ValueNode.prototype.iterate = function (fn, reverse) {\n    return fn(this.entry);\n  }\n\n  createClass(MapIterator, Iterator);\n\n    function MapIterator(map, type, reverse) {\n      this._type = type;\n      this._reverse = reverse;\n      this._stack = map._root && mapIteratorFrame(map._root);\n    }\n\n    MapIterator.prototype.next = function() {\n      var type = this._type;\n      var stack = this._stack;\n      while (stack) {\n        var node = stack.node;\n        var index = stack.index++;\n        var maxIndex;\n        if (node.entry) {\n          if (index === 0) {\n            return mapIteratorValue(type, node.entry);\n          }\n        } else if (node.entries) {\n          maxIndex = node.entries.length - 1;\n          if (index <= maxIndex) {\n            return mapIteratorValue(type, node.entries[this._reverse ? maxIndex - index : index]);\n          }\n        } else {\n          maxIndex = node.nodes.length - 1;\n          if (index <= maxIndex) {\n            var subNode = node.nodes[this._reverse ? maxIndex - index : index];\n            if (subNode) {\n              if (subNode.entry) {\n                return mapIteratorValue(type, subNode.entry);\n              }\n              stack = this._stack = mapIteratorFrame(subNode, stack);\n            }\n            continue;\n          }\n        }\n        stack = this._stack = this._stack.__prev;\n      }\n      return iteratorDone();\n    };\n\n\n  function mapIteratorValue(type, entry) {\n    return iteratorValue(type, entry[0], entry[1]);\n  }\n\n  function mapIteratorFrame(node, prev) {\n    return {\n      node: node,\n      index: 0,\n      __prev: prev\n    };\n  }\n\n  function makeMap(size, root, ownerID, hash) {\n    var map = Object.create(MapPrototype);\n    map.size = size;\n    map._root = root;\n    map.__ownerID = ownerID;\n    map.__hash = hash;\n    map.__altered = false;\n    return map;\n  }\n\n  var EMPTY_MAP;\n  function emptyMap() {\n    return EMPTY_MAP || (EMPTY_MAP = makeMap(0));\n  }\n\n  function updateMap(map, k, v) {\n    var newRoot;\n    var newSize;\n    if (!map._root) {\n      if (v === NOT_SET) {\n        return map;\n      }\n      newSize = 1;\n      newRoot = new ArrayMapNode(map.__ownerID, [[k, v]]);\n    } else {\n      var didChangeSize = MakeRef(CHANGE_LENGTH);\n      var didAlter = MakeRef(DID_ALTER);\n      newRoot = updateNode(map._root, map.__ownerID, 0, undefined, k, v, didChangeSize, didAlter);\n      if (!didAlter.value) {\n        return map;\n      }\n      newSize = map.size + (didChangeSize.value ? v === NOT_SET ? -1 : 1 : 0);\n    }\n    if (map.__ownerID) {\n      map.size = newSize;\n      map._root = newRoot;\n      map.__hash = undefined;\n      map.__altered = true;\n      return map;\n    }\n    return newRoot ? makeMap(newSize, newRoot) : emptyMap();\n  }\n\n  function updateNode(node, ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n    if (!node) {\n      if (value === NOT_SET) {\n        return node;\n      }\n      SetRef(didAlter);\n      SetRef(didChangeSize);\n      return new ValueNode(ownerID, keyHash, [key, value]);\n    }\n    return node.update(ownerID, shift, keyHash, key, value, didChangeSize, didAlter);\n  }\n\n  function isLeafNode(node) {\n    return node.constructor === ValueNode || node.constructor === HashCollisionNode;\n  }\n\n  function mergeIntoNode(node, ownerID, shift, keyHash, entry) {\n    if (node.keyHash === keyHash) {\n      return new HashCollisionNode(ownerID, keyHash, [node.entry, entry]);\n    }\n\n    var idx1 = (shift === 0 ? node.keyHash : node.keyHash >>> shift) & MASK;\n    var idx2 = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n\n    var newNode;\n    var nodes = idx1 === idx2 ?\n      [mergeIntoNode(node, ownerID, shift + SHIFT, keyHash, entry)] :\n      ((newNode = new ValueNode(ownerID, keyHash, entry)), idx1 < idx2 ? [node, newNode] : [newNode, node]);\n\n    return new BitmapIndexedNode(ownerID, (1 << idx1) | (1 << idx2), nodes);\n  }\n\n  function createNodes(ownerID, entries, key, value) {\n    if (!ownerID) {\n      ownerID = new OwnerID();\n    }\n    var node = new ValueNode(ownerID, hash(key), [key, value]);\n    for (var ii = 0; ii < entries.length; ii++) {\n      var entry = entries[ii];\n      node = node.update(ownerID, 0, undefined, entry[0], entry[1]);\n    }\n    return node;\n  }\n\n  function packNodes(ownerID, nodes, count, excluding) {\n    var bitmap = 0;\n    var packedII = 0;\n    var packedNodes = new Array(count);\n    for (var ii = 0, bit = 1, len = nodes.length; ii < len; ii++, bit <<= 1) {\n      var node = nodes[ii];\n      if (node !== undefined && ii !== excluding) {\n        bitmap |= bit;\n        packedNodes[packedII++] = node;\n      }\n    }\n    return new BitmapIndexedNode(ownerID, bitmap, packedNodes);\n  }\n\n  function expandNodes(ownerID, nodes, bitmap, including, node) {\n    var count = 0;\n    var expandedNodes = new Array(SIZE);\n    for (var ii = 0; bitmap !== 0; ii++, bitmap >>>= 1) {\n      expandedNodes[ii] = bitmap & 1 ? nodes[count++] : undefined;\n    }\n    expandedNodes[including] = node;\n    return new HashArrayMapNode(ownerID, count + 1, expandedNodes);\n  }\n\n  function mergeIntoMapWith(map, merger, iterables) {\n    var iters = [];\n    for (var ii = 0; ii < iterables.length; ii++) {\n      var value = iterables[ii];\n      var iter = KeyedIterable(value);\n      if (!isIterable(value)) {\n        iter = iter.map(function(v ) {return fromJS(v)});\n      }\n      iters.push(iter);\n    }\n    return mergeIntoCollectionWith(map, merger, iters);\n  }\n\n  function deepMerger(existing, value, key) {\n    return existing && existing.mergeDeep && isIterable(value) ?\n      existing.mergeDeep(value) :\n      is(existing, value) ? existing : value;\n  }\n\n  function deepMergerWith(merger) {\n    return function(existing, value, key)  {\n      if (existing && existing.mergeDeepWith && isIterable(value)) {\n        return existing.mergeDeepWith(merger, value);\n      }\n      var nextValue = merger(existing, value, key);\n      return is(existing, nextValue) ? existing : nextValue;\n    };\n  }\n\n  function mergeIntoCollectionWith(collection, merger, iters) {\n    iters = iters.filter(function(x ) {return x.size !== 0});\n    if (iters.length === 0) {\n      return collection;\n    }\n    if (collection.size === 0 && !collection.__ownerID && iters.length === 1) {\n      return collection.constructor(iters[0]);\n    }\n    return collection.withMutations(function(collection ) {\n      var mergeIntoMap = merger ?\n        function(value, key)  {\n          collection.update(key, NOT_SET, function(existing )\n            {return existing === NOT_SET ? value : merger(existing, value, key)}\n          );\n        } :\n        function(value, key)  {\n          collection.set(key, value);\n        }\n      for (var ii = 0; ii < iters.length; ii++) {\n        iters[ii].forEach(mergeIntoMap);\n      }\n    });\n  }\n\n  function updateInDeepMap(existing, keyPathIter, notSetValue, updater) {\n    var isNotSet = existing === NOT_SET;\n    var step = keyPathIter.next();\n    if (step.done) {\n      var existingValue = isNotSet ? notSetValue : existing;\n      var newValue = updater(existingValue);\n      return newValue === existingValue ? existing : newValue;\n    }\n    invariant(\n      isNotSet || (existing && existing.set),\n      'invalid keyPath'\n    );\n    var key = step.value;\n    var nextExisting = isNotSet ? NOT_SET : existing.get(key, NOT_SET);\n    var nextUpdated = updateInDeepMap(\n      nextExisting,\n      keyPathIter,\n      notSetValue,\n      updater\n    );\n    return nextUpdated === nextExisting ? existing :\n      nextUpdated === NOT_SET ? existing.remove(key) :\n      (isNotSet ? emptyMap() : existing).set(key, nextUpdated);\n  }\n\n  function popCount(x) {\n    x = x - ((x >> 1) & 0x55555555);\n    x = (x & 0x33333333) + ((x >> 2) & 0x33333333);\n    x = (x + (x >> 4)) & 0x0f0f0f0f;\n    x = x + (x >> 8);\n    x = x + (x >> 16);\n    return x & 0x7f;\n  }\n\n  function setIn(array, idx, val, canEdit) {\n    var newArray = canEdit ? array : arrCopy(array);\n    newArray[idx] = val;\n    return newArray;\n  }\n\n  function spliceIn(array, idx, val, canEdit) {\n    var newLen = array.length + 1;\n    if (canEdit && idx + 1 === newLen) {\n      array[idx] = val;\n      return array;\n    }\n    var newArray = new Array(newLen);\n    var after = 0;\n    for (var ii = 0; ii < newLen; ii++) {\n      if (ii === idx) {\n        newArray[ii] = val;\n        after = -1;\n      } else {\n        newArray[ii] = array[ii + after];\n      }\n    }\n    return newArray;\n  }\n\n  function spliceOut(array, idx, canEdit) {\n    var newLen = array.length - 1;\n    if (canEdit && idx === newLen) {\n      array.pop();\n      return array;\n    }\n    var newArray = new Array(newLen);\n    var after = 0;\n    for (var ii = 0; ii < newLen; ii++) {\n      if (ii === idx) {\n        after = 1;\n      }\n      newArray[ii] = array[ii + after];\n    }\n    return newArray;\n  }\n\n  var MAX_ARRAY_MAP_SIZE = SIZE / 4;\n  var MAX_BITMAP_INDEXED_SIZE = SIZE / 2;\n  var MIN_HASH_ARRAY_MAP_SIZE = SIZE / 4;\n\n  createClass(List, IndexedCollection);\n\n    // @pragma Construction\n\n    function List(value) {\n      var empty = emptyList();\n      if (value === null || value === undefined) {\n        return empty;\n      }\n      if (isList(value)) {\n        return value;\n      }\n      var iter = IndexedIterable(value);\n      var size = iter.size;\n      if (size === 0) {\n        return empty;\n      }\n      assertNotInfinite(size);\n      if (size > 0 && size < SIZE) {\n        return makeList(0, size, SHIFT, null, new VNode(iter.toArray()));\n      }\n      return empty.withMutations(function(list ) {\n        list.setSize(size);\n        iter.forEach(function(v, i)  {return list.set(i, v)});\n      });\n    }\n\n    List.of = function(/*...values*/) {\n      return this(arguments);\n    };\n\n    List.prototype.toString = function() {\n      return this.__toString('List [', ']');\n    };\n\n    // @pragma Access\n\n    List.prototype.get = function(index, notSetValue) {\n      index = wrapIndex(this, index);\n      if (index >= 0 && index < this.size) {\n        index += this._origin;\n        var node = listNodeFor(this, index);\n        return node && node.array[index & MASK];\n      }\n      return notSetValue;\n    };\n\n    // @pragma Modification\n\n    List.prototype.set = function(index, value) {\n      return updateList(this, index, value);\n    };\n\n    List.prototype.remove = function(index) {\n      return !this.has(index) ? this :\n        index === 0 ? this.shift() :\n        index === this.size - 1 ? this.pop() :\n        this.splice(index, 1);\n    };\n\n    List.prototype.insert = function(index, value) {\n      return this.splice(index, 0, value);\n    };\n\n    List.prototype.clear = function() {\n      if (this.size === 0) {\n        return this;\n      }\n      if (this.__ownerID) {\n        this.size = this._origin = this._capacity = 0;\n        this._level = SHIFT;\n        this._root = this._tail = null;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return emptyList();\n    };\n\n    List.prototype.push = function(/*...values*/) {\n      var values = arguments;\n      var oldSize = this.size;\n      return this.withMutations(function(list ) {\n        setListBounds(list, 0, oldSize + values.length);\n        for (var ii = 0; ii < values.length; ii++) {\n          list.set(oldSize + ii, values[ii]);\n        }\n      });\n    };\n\n    List.prototype.pop = function() {\n      return setListBounds(this, 0, -1);\n    };\n\n    List.prototype.unshift = function(/*...values*/) {\n      var values = arguments;\n      return this.withMutations(function(list ) {\n        setListBounds(list, -values.length);\n        for (var ii = 0; ii < values.length; ii++) {\n          list.set(ii, values[ii]);\n        }\n      });\n    };\n\n    List.prototype.shift = function() {\n      return setListBounds(this, 1);\n    };\n\n    // @pragma Composition\n\n    List.prototype.merge = function(/*...iters*/) {\n      return mergeIntoListWith(this, undefined, arguments);\n    };\n\n    List.prototype.mergeWith = function(merger) {var iters = SLICE$0.call(arguments, 1);\n      return mergeIntoListWith(this, merger, iters);\n    };\n\n    List.prototype.mergeDeep = function(/*...iters*/) {\n      return mergeIntoListWith(this, deepMerger, arguments);\n    };\n\n    List.prototype.mergeDeepWith = function(merger) {var iters = SLICE$0.call(arguments, 1);\n      return mergeIntoListWith(this, deepMergerWith(merger), iters);\n    };\n\n    List.prototype.setSize = function(size) {\n      return setListBounds(this, 0, size);\n    };\n\n    // @pragma Iteration\n\n    List.prototype.slice = function(begin, end) {\n      var size = this.size;\n      if (wholeSlice(begin, end, size)) {\n        return this;\n      }\n      return setListBounds(\n        this,\n        resolveBegin(begin, size),\n        resolveEnd(end, size)\n      );\n    };\n\n    List.prototype.__iterator = function(type, reverse) {\n      var index = 0;\n      var values = iterateList(this, reverse);\n      return new Iterator(function()  {\n        var value = values();\n        return value === DONE ?\n          iteratorDone() :\n          iteratorValue(type, index++, value);\n      });\n    };\n\n    List.prototype.__iterate = function(fn, reverse) {\n      var index = 0;\n      var values = iterateList(this, reverse);\n      var value;\n      while ((value = values()) !== DONE) {\n        if (fn(value, index++, this) === false) {\n          break;\n        }\n      }\n      return index;\n    };\n\n    List.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        return this;\n      }\n      return makeList(this._origin, this._capacity, this._level, this._root, this._tail, ownerID, this.__hash);\n    };\n\n\n  function isList(maybeList) {\n    return !!(maybeList && maybeList[IS_LIST_SENTINEL]);\n  }\n\n  List.isList = isList;\n\n  var IS_LIST_SENTINEL = '@@__IMMUTABLE_LIST__@@';\n\n  var ListPrototype = List.prototype;\n  ListPrototype[IS_LIST_SENTINEL] = true;\n  ListPrototype[DELETE] = ListPrototype.remove;\n  ListPrototype.setIn = MapPrototype.setIn;\n  ListPrototype.deleteIn =\n  ListPrototype.removeIn = MapPrototype.removeIn;\n  ListPrototype.update = MapPrototype.update;\n  ListPrototype.updateIn = MapPrototype.updateIn;\n  ListPrototype.mergeIn = MapPrototype.mergeIn;\n  ListPrototype.mergeDeepIn = MapPrototype.mergeDeepIn;\n  ListPrototype.withMutations = MapPrototype.withMutations;\n  ListPrototype.asMutable = MapPrototype.asMutable;\n  ListPrototype.asImmutable = MapPrototype.asImmutable;\n  ListPrototype.wasAltered = MapPrototype.wasAltered;\n\n\n\n    function VNode(array, ownerID) {\n      this.array = array;\n      this.ownerID = ownerID;\n    }\n\n    // TODO: seems like these methods are very similar\n\n    VNode.prototype.removeBefore = function(ownerID, level, index) {\n      if (index === level ? 1 << level : 0 || this.array.length === 0) {\n        return this;\n      }\n      var originIndex = (index >>> level) & MASK;\n      if (originIndex >= this.array.length) {\n        return new VNode([], ownerID);\n      }\n      var removingFirst = originIndex === 0;\n      var newChild;\n      if (level > 0) {\n        var oldChild = this.array[originIndex];\n        newChild = oldChild && oldChild.removeBefore(ownerID, level - SHIFT, index);\n        if (newChild === oldChild && removingFirst) {\n          return this;\n        }\n      }\n      if (removingFirst && !newChild) {\n        return this;\n      }\n      var editable = editableVNode(this, ownerID);\n      if (!removingFirst) {\n        for (var ii = 0; ii < originIndex; ii++) {\n          editable.array[ii] = undefined;\n        }\n      }\n      if (newChild) {\n        editable.array[originIndex] = newChild;\n      }\n      return editable;\n    };\n\n    VNode.prototype.removeAfter = function(ownerID, level, index) {\n      if (index === (level ? 1 << level : 0) || this.array.length === 0) {\n        return this;\n      }\n      var sizeIndex = ((index - 1) >>> level) & MASK;\n      if (sizeIndex >= this.array.length) {\n        return this;\n      }\n\n      var newChild;\n      if (level > 0) {\n        var oldChild = this.array[sizeIndex];\n        newChild = oldChild && oldChild.removeAfter(ownerID, level - SHIFT, index);\n        if (newChild === oldChild && sizeIndex === this.array.length - 1) {\n          return this;\n        }\n      }\n\n      var editable = editableVNode(this, ownerID);\n      editable.array.splice(sizeIndex + 1);\n      if (newChild) {\n        editable.array[sizeIndex] = newChild;\n      }\n      return editable;\n    };\n\n\n\n  var DONE = {};\n\n  function iterateList(list, reverse) {\n    var left = list._origin;\n    var right = list._capacity;\n    var tailPos = getTailOffset(right);\n    var tail = list._tail;\n\n    return iterateNodeOrLeaf(list._root, list._level, 0);\n\n    function iterateNodeOrLeaf(node, level, offset) {\n      return level === 0 ?\n        iterateLeaf(node, offset) :\n        iterateNode(node, level, offset);\n    }\n\n    function iterateLeaf(node, offset) {\n      var array = offset === tailPos ? tail && tail.array : node && node.array;\n      var from = offset > left ? 0 : left - offset;\n      var to = right - offset;\n      if (to > SIZE) {\n        to = SIZE;\n      }\n      return function()  {\n        if (from === to) {\n          return DONE;\n        }\n        var idx = reverse ? --to : from++;\n        return array && array[idx];\n      };\n    }\n\n    function iterateNode(node, level, offset) {\n      var values;\n      var array = node && node.array;\n      var from = offset > left ? 0 : (left - offset) >> level;\n      var to = ((right - offset) >> level) + 1;\n      if (to > SIZE) {\n        to = SIZE;\n      }\n      return function()  {\n        do {\n          if (values) {\n            var value = values();\n            if (value !== DONE) {\n              return value;\n            }\n            values = null;\n          }\n          if (from === to) {\n            return DONE;\n          }\n          var idx = reverse ? --to : from++;\n          values = iterateNodeOrLeaf(\n            array && array[idx], level - SHIFT, offset + (idx << level)\n          );\n        } while (true);\n      };\n    }\n  }\n\n  function makeList(origin, capacity, level, root, tail, ownerID, hash) {\n    var list = Object.create(ListPrototype);\n    list.size = capacity - origin;\n    list._origin = origin;\n    list._capacity = capacity;\n    list._level = level;\n    list._root = root;\n    list._tail = tail;\n    list.__ownerID = ownerID;\n    list.__hash = hash;\n    list.__altered = false;\n    return list;\n  }\n\n  var EMPTY_LIST;\n  function emptyList() {\n    return EMPTY_LIST || (EMPTY_LIST = makeList(0, 0, SHIFT));\n  }\n\n  function updateList(list, index, value) {\n    index = wrapIndex(list, index);\n\n    if (index !== index) {\n      return list;\n    }\n\n    if (index >= list.size || index < 0) {\n      return list.withMutations(function(list ) {\n        index < 0 ?\n          setListBounds(list, index).set(0, value) :\n          setListBounds(list, 0, index + 1).set(index, value)\n      });\n    }\n\n    index += list._origin;\n\n    var newTail = list._tail;\n    var newRoot = list._root;\n    var didAlter = MakeRef(DID_ALTER);\n    if (index >= getTailOffset(list._capacity)) {\n      newTail = updateVNode(newTail, list.__ownerID, 0, index, value, didAlter);\n    } else {\n      newRoot = updateVNode(newRoot, list.__ownerID, list._level, index, value, didAlter);\n    }\n\n    if (!didAlter.value) {\n      return list;\n    }\n\n    if (list.__ownerID) {\n      list._root = newRoot;\n      list._tail = newTail;\n      list.__hash = undefined;\n      list.__altered = true;\n      return list;\n    }\n    return makeList(list._origin, list._capacity, list._level, newRoot, newTail);\n  }\n\n  function updateVNode(node, ownerID, level, index, value, didAlter) {\n    var idx = (index >>> level) & MASK;\n    var nodeHas = node && idx < node.array.length;\n    if (!nodeHas && value === undefined) {\n      return node;\n    }\n\n    var newNode;\n\n    if (level > 0) {\n      var lowerNode = node && node.array[idx];\n      var newLowerNode = updateVNode(lowerNode, ownerID, level - SHIFT, index, value, didAlter);\n      if (newLowerNode === lowerNode) {\n        return node;\n      }\n      newNode = editableVNode(node, ownerID);\n      newNode.array[idx] = newLowerNode;\n      return newNode;\n    }\n\n    if (nodeHas && node.array[idx] === value) {\n      return node;\n    }\n\n    SetRef(didAlter);\n\n    newNode = editableVNode(node, ownerID);\n    if (value === undefined && idx === newNode.array.length - 1) {\n      newNode.array.pop();\n    } else {\n      newNode.array[idx] = value;\n    }\n    return newNode;\n  }\n\n  function editableVNode(node, ownerID) {\n    if (ownerID && node && ownerID === node.ownerID) {\n      return node;\n    }\n    return new VNode(node ? node.array.slice() : [], ownerID);\n  }\n\n  function listNodeFor(list, rawIndex) {\n    if (rawIndex >= getTailOffset(list._capacity)) {\n      return list._tail;\n    }\n    if (rawIndex < 1 << (list._level + SHIFT)) {\n      var node = list._root;\n      var level = list._level;\n      while (node && level > 0) {\n        node = node.array[(rawIndex >>> level) & MASK];\n        level -= SHIFT;\n      }\n      return node;\n    }\n  }\n\n  function setListBounds(list, begin, end) {\n    // Sanitize begin & end using this shorthand for ToInt32(argument)\n    // http://www.ecma-international.org/ecma-262/6.0/#sec-toint32\n    if (begin !== undefined) {\n      begin = begin | 0;\n    }\n    if (end !== undefined) {\n      end = end | 0;\n    }\n    var owner = list.__ownerID || new OwnerID();\n    var oldOrigin = list._origin;\n    var oldCapacity = list._capacity;\n    var newOrigin = oldOrigin + begin;\n    var newCapacity = end === undefined ? oldCapacity : end < 0 ? oldCapacity + end : oldOrigin + end;\n    if (newOrigin === oldOrigin && newCapacity === oldCapacity) {\n      return list;\n    }\n\n    // If it's going to end after it starts, it's empty.\n    if (newOrigin >= newCapacity) {\n      return list.clear();\n    }\n\n    var newLevel = list._level;\n    var newRoot = list._root;\n\n    // New origin might need creating a higher root.\n    var offsetShift = 0;\n    while (newOrigin + offsetShift < 0) {\n      newRoot = new VNode(newRoot && newRoot.array.length ? [undefined, newRoot] : [], owner);\n      newLevel += SHIFT;\n      offsetShift += 1 << newLevel;\n    }\n    if (offsetShift) {\n      newOrigin += offsetShift;\n      oldOrigin += offsetShift;\n      newCapacity += offsetShift;\n      oldCapacity += offsetShift;\n    }\n\n    var oldTailOffset = getTailOffset(oldCapacity);\n    var newTailOffset = getTailOffset(newCapacity);\n\n    // New size might need creating a higher root.\n    while (newTailOffset >= 1 << (newLevel + SHIFT)) {\n      newRoot = new VNode(newRoot && newRoot.array.length ? [newRoot] : [], owner);\n      newLevel += SHIFT;\n    }\n\n    // Locate or create the new tail.\n    var oldTail = list._tail;\n    var newTail = newTailOffset < oldTailOffset ?\n      listNodeFor(list, newCapacity - 1) :\n      newTailOffset > oldTailOffset ? new VNode([], owner) : oldTail;\n\n    // Merge Tail into tree.\n    if (oldTail && newTailOffset > oldTailOffset && newOrigin < oldCapacity && oldTail.array.length) {\n      newRoot = editableVNode(newRoot, owner);\n      var node = newRoot;\n      for (var level = newLevel; level > SHIFT; level -= SHIFT) {\n        var idx = (oldTailOffset >>> level) & MASK;\n        node = node.array[idx] = editableVNode(node.array[idx], owner);\n      }\n      node.array[(oldTailOffset >>> SHIFT) & MASK] = oldTail;\n    }\n\n    // If the size has been reduced, there's a chance the tail needs to be trimmed.\n    if (newCapacity < oldCapacity) {\n      newTail = newTail && newTail.removeAfter(owner, 0, newCapacity);\n    }\n\n    // If the new origin is within the tail, then we do not need a root.\n    if (newOrigin >= newTailOffset) {\n      newOrigin -= newTailOffset;\n      newCapacity -= newTailOffset;\n      newLevel = SHIFT;\n      newRoot = null;\n      newTail = newTail && newTail.removeBefore(owner, 0, newOrigin);\n\n    // Otherwise, if the root has been trimmed, garbage collect.\n    } else if (newOrigin > oldOrigin || newTailOffset < oldTailOffset) {\n      offsetShift = 0;\n\n      // Identify the new top root node of the subtree of the old root.\n      while (newRoot) {\n        var beginIndex = (newOrigin >>> newLevel) & MASK;\n        if (beginIndex !== (newTailOffset >>> newLevel) & MASK) {\n          break;\n        }\n        if (beginIndex) {\n          offsetShift += (1 << newLevel) * beginIndex;\n        }\n        newLevel -= SHIFT;\n        newRoot = newRoot.array[beginIndex];\n      }\n\n      // Trim the new sides of the new root.\n      if (newRoot && newOrigin > oldOrigin) {\n        newRoot = newRoot.removeBefore(owner, newLevel, newOrigin - offsetShift);\n      }\n      if (newRoot && newTailOffset < oldTailOffset) {\n        newRoot = newRoot.removeAfter(owner, newLevel, newTailOffset - offsetShift);\n      }\n      if (offsetShift) {\n        newOrigin -= offsetShift;\n        newCapacity -= offsetShift;\n      }\n    }\n\n    if (list.__ownerID) {\n      list.size = newCapacity - newOrigin;\n      list._origin = newOrigin;\n      list._capacity = newCapacity;\n      list._level = newLevel;\n      list._root = newRoot;\n      list._tail = newTail;\n      list.__hash = undefined;\n      list.__altered = true;\n      return list;\n    }\n    return makeList(newOrigin, newCapacity, newLevel, newRoot, newTail);\n  }\n\n  function mergeIntoListWith(list, merger, iterables) {\n    var iters = [];\n    var maxSize = 0;\n    for (var ii = 0; ii < iterables.length; ii++) {\n      var value = iterables[ii];\n      var iter = IndexedIterable(value);\n      if (iter.size > maxSize) {\n        maxSize = iter.size;\n      }\n      if (!isIterable(value)) {\n        iter = iter.map(function(v ) {return fromJS(v)});\n      }\n      iters.push(iter);\n    }\n    if (maxSize > list.size) {\n      list = list.setSize(maxSize);\n    }\n    return mergeIntoCollectionWith(list, merger, iters);\n  }\n\n  function getTailOffset(size) {\n    return size < SIZE ? 0 : (((size - 1) >>> SHIFT) << SHIFT);\n  }\n\n  createClass(OrderedMap, Map);\n\n    // @pragma Construction\n\n    function OrderedMap(value) {\n      return value === null || value === undefined ? emptyOrderedMap() :\n        isOrderedMap(value) ? value :\n        emptyOrderedMap().withMutations(function(map ) {\n          var iter = KeyedIterable(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function(v, k)  {return map.set(k, v)});\n        });\n    }\n\n    OrderedMap.of = function(/*...values*/) {\n      return this(arguments);\n    };\n\n    OrderedMap.prototype.toString = function() {\n      return this.__toString('OrderedMap {', '}');\n    };\n\n    // @pragma Access\n\n    OrderedMap.prototype.get = function(k, notSetValue) {\n      var index = this._map.get(k);\n      return index !== undefined ? this._list.get(index)[1] : notSetValue;\n    };\n\n    // @pragma Modification\n\n    OrderedMap.prototype.clear = function() {\n      if (this.size === 0) {\n        return this;\n      }\n      if (this.__ownerID) {\n        this.size = 0;\n        this._map.clear();\n        this._list.clear();\n        return this;\n      }\n      return emptyOrderedMap();\n    };\n\n    OrderedMap.prototype.set = function(k, v) {\n      return updateOrderedMap(this, k, v);\n    };\n\n    OrderedMap.prototype.remove = function(k) {\n      return updateOrderedMap(this, k, NOT_SET);\n    };\n\n    OrderedMap.prototype.wasAltered = function() {\n      return this._map.wasAltered() || this._list.wasAltered();\n    };\n\n    OrderedMap.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      return this._list.__iterate(\n        function(entry ) {return entry && fn(entry[1], entry[0], this$0)},\n        reverse\n      );\n    };\n\n    OrderedMap.prototype.__iterator = function(type, reverse) {\n      return this._list.fromEntrySeq().__iterator(type, reverse);\n    };\n\n    OrderedMap.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      var newMap = this._map.__ensureOwner(ownerID);\n      var newList = this._list.__ensureOwner(ownerID);\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        this._map = newMap;\n        this._list = newList;\n        return this;\n      }\n      return makeOrderedMap(newMap, newList, ownerID, this.__hash);\n    };\n\n\n  function isOrderedMap(maybeOrderedMap) {\n    return isMap(maybeOrderedMap) && isOrdered(maybeOrderedMap);\n  }\n\n  OrderedMap.isOrderedMap = isOrderedMap;\n\n  OrderedMap.prototype[IS_ORDERED_SENTINEL] = true;\n  OrderedMap.prototype[DELETE] = OrderedMap.prototype.remove;\n\n\n\n  function makeOrderedMap(map, list, ownerID, hash) {\n    var omap = Object.create(OrderedMap.prototype);\n    omap.size = map ? map.size : 0;\n    omap._map = map;\n    omap._list = list;\n    omap.__ownerID = ownerID;\n    omap.__hash = hash;\n    return omap;\n  }\n\n  var EMPTY_ORDERED_MAP;\n  function emptyOrderedMap() {\n    return EMPTY_ORDERED_MAP || (EMPTY_ORDERED_MAP = makeOrderedMap(emptyMap(), emptyList()));\n  }\n\n  function updateOrderedMap(omap, k, v) {\n    var map = omap._map;\n    var list = omap._list;\n    var i = map.get(k);\n    var has = i !== undefined;\n    var newMap;\n    var newList;\n    if (v === NOT_SET) { // removed\n      if (!has) {\n        return omap;\n      }\n      if (list.size >= SIZE && list.size >= map.size * 2) {\n        newList = list.filter(function(entry, idx)  {return entry !== undefined && i !== idx});\n        newMap = newList.toKeyedSeq().map(function(entry ) {return entry[0]}).flip().toMap();\n        if (omap.__ownerID) {\n          newMap.__ownerID = newList.__ownerID = omap.__ownerID;\n        }\n      } else {\n        newMap = map.remove(k);\n        newList = i === list.size - 1 ? list.pop() : list.set(i, undefined);\n      }\n    } else {\n      if (has) {\n        if (v === list.get(i)[1]) {\n          return omap;\n        }\n        newMap = map;\n        newList = list.set(i, [k, v]);\n      } else {\n        newMap = map.set(k, list.size);\n        newList = list.set(list.size, [k, v]);\n      }\n    }\n    if (omap.__ownerID) {\n      omap.size = newMap.size;\n      omap._map = newMap;\n      omap._list = newList;\n      omap.__hash = undefined;\n      return omap;\n    }\n    return makeOrderedMap(newMap, newList);\n  }\n\n  createClass(ToKeyedSequence, KeyedSeq);\n    function ToKeyedSequence(indexed, useKeys) {\n      this._iter = indexed;\n      this._useKeys = useKeys;\n      this.size = indexed.size;\n    }\n\n    ToKeyedSequence.prototype.get = function(key, notSetValue) {\n      return this._iter.get(key, notSetValue);\n    };\n\n    ToKeyedSequence.prototype.has = function(key) {\n      return this._iter.has(key);\n    };\n\n    ToKeyedSequence.prototype.valueSeq = function() {\n      return this._iter.valueSeq();\n    };\n\n    ToKeyedSequence.prototype.reverse = function() {var this$0 = this;\n      var reversedSequence = reverseFactory(this, true);\n      if (!this._useKeys) {\n        reversedSequence.valueSeq = function()  {return this$0._iter.toSeq().reverse()};\n      }\n      return reversedSequence;\n    };\n\n    ToKeyedSequence.prototype.map = function(mapper, context) {var this$0 = this;\n      var mappedSequence = mapFactory(this, mapper, context);\n      if (!this._useKeys) {\n        mappedSequence.valueSeq = function()  {return this$0._iter.toSeq().map(mapper, context)};\n      }\n      return mappedSequence;\n    };\n\n    ToKeyedSequence.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      var ii;\n      return this._iter.__iterate(\n        this._useKeys ?\n          function(v, k)  {return fn(v, k, this$0)} :\n          ((ii = reverse ? resolveSize(this) : 0),\n            function(v ) {return fn(v, reverse ? --ii : ii++, this$0)}),\n        reverse\n      );\n    };\n\n    ToKeyedSequence.prototype.__iterator = function(type, reverse) {\n      if (this._useKeys) {\n        return this._iter.__iterator(type, reverse);\n      }\n      var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n      var ii = reverse ? resolveSize(this) : 0;\n      return new Iterator(function()  {\n        var step = iterator.next();\n        return step.done ? step :\n          iteratorValue(type, reverse ? --ii : ii++, step.value, step);\n      });\n    };\n\n  ToKeyedSequence.prototype[IS_ORDERED_SENTINEL] = true;\n\n\n  createClass(ToIndexedSequence, IndexedSeq);\n    function ToIndexedSequence(iter) {\n      this._iter = iter;\n      this.size = iter.size;\n    }\n\n    ToIndexedSequence.prototype.includes = function(value) {\n      return this._iter.includes(value);\n    };\n\n    ToIndexedSequence.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      var iterations = 0;\n      return this._iter.__iterate(function(v ) {return fn(v, iterations++, this$0)}, reverse);\n    };\n\n    ToIndexedSequence.prototype.__iterator = function(type, reverse) {\n      var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n      var iterations = 0;\n      return new Iterator(function()  {\n        var step = iterator.next();\n        return step.done ? step :\n          iteratorValue(type, iterations++, step.value, step)\n      });\n    };\n\n\n\n  createClass(ToSetSequence, SetSeq);\n    function ToSetSequence(iter) {\n      this._iter = iter;\n      this.size = iter.size;\n    }\n\n    ToSetSequence.prototype.has = function(key) {\n      return this._iter.includes(key);\n    };\n\n    ToSetSequence.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      return this._iter.__iterate(function(v ) {return fn(v, v, this$0)}, reverse);\n    };\n\n    ToSetSequence.prototype.__iterator = function(type, reverse) {\n      var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n      return new Iterator(function()  {\n        var step = iterator.next();\n        return step.done ? step :\n          iteratorValue(type, step.value, step.value, step);\n      });\n    };\n\n\n\n  createClass(FromEntriesSequence, KeyedSeq);\n    function FromEntriesSequence(entries) {\n      this._iter = entries;\n      this.size = entries.size;\n    }\n\n    FromEntriesSequence.prototype.entrySeq = function() {\n      return this._iter.toSeq();\n    };\n\n    FromEntriesSequence.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      return this._iter.__iterate(function(entry ) {\n        // Check if entry exists first so array access doesn't throw for holes\n        // in the parent iteration.\n        if (entry) {\n          validateEntry(entry);\n          var indexedIterable = isIterable(entry);\n          return fn(\n            indexedIterable ? entry.get(1) : entry[1],\n            indexedIterable ? entry.get(0) : entry[0],\n            this$0\n          );\n        }\n      }, reverse);\n    };\n\n    FromEntriesSequence.prototype.__iterator = function(type, reverse) {\n      var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n      return new Iterator(function()  {\n        while (true) {\n          var step = iterator.next();\n          if (step.done) {\n            return step;\n          }\n          var entry = step.value;\n          // Check if entry exists first so array access doesn't throw for holes\n          // in the parent iteration.\n          if (entry) {\n            validateEntry(entry);\n            var indexedIterable = isIterable(entry);\n            return iteratorValue(\n              type,\n              indexedIterable ? entry.get(0) : entry[0],\n              indexedIterable ? entry.get(1) : entry[1],\n              step\n            );\n          }\n        }\n      });\n    };\n\n\n  ToIndexedSequence.prototype.cacheResult =\n  ToKeyedSequence.prototype.cacheResult =\n  ToSetSequence.prototype.cacheResult =\n  FromEntriesSequence.prototype.cacheResult =\n    cacheResultThrough;\n\n\n  function flipFactory(iterable) {\n    var flipSequence = makeSequence(iterable);\n    flipSequence._iter = iterable;\n    flipSequence.size = iterable.size;\n    flipSequence.flip = function()  {return iterable};\n    flipSequence.reverse = function () {\n      var reversedSequence = iterable.reverse.apply(this); // super.reverse()\n      reversedSequence.flip = function()  {return iterable.reverse()};\n      return reversedSequence;\n    };\n    flipSequence.has = function(key ) {return iterable.includes(key)};\n    flipSequence.includes = function(key ) {return iterable.has(key)};\n    flipSequence.cacheResult = cacheResultThrough;\n    flipSequence.__iterateUncached = function (fn, reverse) {var this$0 = this;\n      return iterable.__iterate(function(v, k)  {return fn(k, v, this$0) !== false}, reverse);\n    }\n    flipSequence.__iteratorUncached = function(type, reverse) {\n      if (type === ITERATE_ENTRIES) {\n        var iterator = iterable.__iterator(type, reverse);\n        return new Iterator(function()  {\n          var step = iterator.next();\n          if (!step.done) {\n            var k = step.value[0];\n            step.value[0] = step.value[1];\n            step.value[1] = k;\n          }\n          return step;\n        });\n      }\n      return iterable.__iterator(\n        type === ITERATE_VALUES ? ITERATE_KEYS : ITERATE_VALUES,\n        reverse\n      );\n    }\n    return flipSequence;\n  }\n\n\n  function mapFactory(iterable, mapper, context) {\n    var mappedSequence = makeSequence(iterable);\n    mappedSequence.size = iterable.size;\n    mappedSequence.has = function(key ) {return iterable.has(key)};\n    mappedSequence.get = function(key, notSetValue)  {\n      var v = iterable.get(key, NOT_SET);\n      return v === NOT_SET ?\n        notSetValue :\n        mapper.call(context, v, key, iterable);\n    };\n    mappedSequence.__iterateUncached = function (fn, reverse) {var this$0 = this;\n      return iterable.__iterate(\n        function(v, k, c)  {return fn(mapper.call(context, v, k, c), k, this$0) !== false},\n        reverse\n      );\n    }\n    mappedSequence.__iteratorUncached = function (type, reverse) {\n      var iterator = iterable.__iterator(ITERATE_ENTRIES, reverse);\n      return new Iterator(function()  {\n        var step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n        var entry = step.value;\n        var key = entry[0];\n        return iteratorValue(\n          type,\n          key,\n          mapper.call(context, entry[1], key, iterable),\n          step\n        );\n      });\n    }\n    return mappedSequence;\n  }\n\n\n  function reverseFactory(iterable, useKeys) {\n    var reversedSequence = makeSequence(iterable);\n    reversedSequence._iter = iterable;\n    reversedSequence.size = iterable.size;\n    reversedSequence.reverse = function()  {return iterable};\n    if (iterable.flip) {\n      reversedSequence.flip = function () {\n        var flipSequence = flipFactory(iterable);\n        flipSequence.reverse = function()  {return iterable.flip()};\n        return flipSequence;\n      };\n    }\n    reversedSequence.get = function(key, notSetValue) \n      {return iterable.get(useKeys ? key : -1 - key, notSetValue)};\n    reversedSequence.has = function(key )\n      {return iterable.has(useKeys ? key : -1 - key)};\n    reversedSequence.includes = function(value ) {return iterable.includes(value)};\n    reversedSequence.cacheResult = cacheResultThrough;\n    reversedSequence.__iterate = function (fn, reverse) {var this$0 = this;\n      return iterable.__iterate(function(v, k)  {return fn(v, k, this$0)}, !reverse);\n    };\n    reversedSequence.__iterator =\n      function(type, reverse)  {return iterable.__iterator(type, !reverse)};\n    return reversedSequence;\n  }\n\n\n  function filterFactory(iterable, predicate, context, useKeys) {\n    var filterSequence = makeSequence(iterable);\n    if (useKeys) {\n      filterSequence.has = function(key ) {\n        var v = iterable.get(key, NOT_SET);\n        return v !== NOT_SET && !!predicate.call(context, v, key, iterable);\n      };\n      filterSequence.get = function(key, notSetValue)  {\n        var v = iterable.get(key, NOT_SET);\n        return v !== NOT_SET && predicate.call(context, v, key, iterable) ?\n          v : notSetValue;\n      };\n    }\n    filterSequence.__iterateUncached = function (fn, reverse) {var this$0 = this;\n      var iterations = 0;\n      iterable.__iterate(function(v, k, c)  {\n        if (predicate.call(context, v, k, c)) {\n          iterations++;\n          return fn(v, useKeys ? k : iterations - 1, this$0);\n        }\n      }, reverse);\n      return iterations;\n    };\n    filterSequence.__iteratorUncached = function (type, reverse) {\n      var iterator = iterable.__iterator(ITERATE_ENTRIES, reverse);\n      var iterations = 0;\n      return new Iterator(function()  {\n        while (true) {\n          var step = iterator.next();\n          if (step.done) {\n            return step;\n          }\n          var entry = step.value;\n          var key = entry[0];\n          var value = entry[1];\n          if (predicate.call(context, value, key, iterable)) {\n            return iteratorValue(type, useKeys ? key : iterations++, value, step);\n          }\n        }\n      });\n    }\n    return filterSequence;\n  }\n\n\n  function countByFactory(iterable, grouper, context) {\n    var groups = Map().asMutable();\n    iterable.__iterate(function(v, k)  {\n      groups.update(\n        grouper.call(context, v, k, iterable),\n        0,\n        function(a ) {return a + 1}\n      );\n    });\n    return groups.asImmutable();\n  }\n\n\n  function groupByFactory(iterable, grouper, context) {\n    var isKeyedIter = isKeyed(iterable);\n    var groups = (isOrdered(iterable) ? OrderedMap() : Map()).asMutable();\n    iterable.__iterate(function(v, k)  {\n      groups.update(\n        grouper.call(context, v, k, iterable),\n        function(a ) {return (a = a || [], a.push(isKeyedIter ? [k, v] : v), a)}\n      );\n    });\n    var coerce = iterableClass(iterable);\n    return groups.map(function(arr ) {return reify(iterable, coerce(arr))});\n  }\n\n\n  function sliceFactory(iterable, begin, end, useKeys) {\n    var originalSize = iterable.size;\n\n    // Sanitize begin & end using this shorthand for ToInt32(argument)\n    // http://www.ecma-international.org/ecma-262/6.0/#sec-toint32\n    if (begin !== undefined) {\n      begin = begin | 0;\n    }\n    if (end !== undefined) {\n      if (end === Infinity) {\n        end = originalSize;\n      } else {\n        end = end | 0;\n      }\n    }\n\n    if (wholeSlice(begin, end, originalSize)) {\n      return iterable;\n    }\n\n    var resolvedBegin = resolveBegin(begin, originalSize);\n    var resolvedEnd = resolveEnd(end, originalSize);\n\n    // begin or end will be NaN if they were provided as negative numbers and\n    // this iterable's size is unknown. In that case, cache first so there is\n    // a known size and these do not resolve to NaN.\n    if (resolvedBegin !== resolvedBegin || resolvedEnd !== resolvedEnd) {\n      return sliceFactory(iterable.toSeq().cacheResult(), begin, end, useKeys);\n    }\n\n    // Note: resolvedEnd is undefined when the original sequence's length is\n    // unknown and this slice did not supply an end and should contain all\n    // elements after resolvedBegin.\n    // In that case, resolvedSize will be NaN and sliceSize will remain undefined.\n    var resolvedSize = resolvedEnd - resolvedBegin;\n    var sliceSize;\n    if (resolvedSize === resolvedSize) {\n      sliceSize = resolvedSize < 0 ? 0 : resolvedSize;\n    }\n\n    var sliceSeq = makeSequence(iterable);\n\n    // If iterable.size is undefined, the size of the realized sliceSeq is\n    // unknown at this point unless the number of items to slice is 0\n    sliceSeq.size = sliceSize === 0 ? sliceSize : iterable.size && sliceSize || undefined;\n\n    if (!useKeys && isSeq(iterable) && sliceSize >= 0) {\n      sliceSeq.get = function (index, notSetValue) {\n        index = wrapIndex(this, index);\n        return index >= 0 && index < sliceSize ?\n          iterable.get(index + resolvedBegin, notSetValue) :\n          notSetValue;\n      }\n    }\n\n    sliceSeq.__iterateUncached = function(fn, reverse) {var this$0 = this;\n      if (sliceSize === 0) {\n        return 0;\n      }\n      if (reverse) {\n        return this.cacheResult().__iterate(fn, reverse);\n      }\n      var skipped = 0;\n      var isSkipping = true;\n      var iterations = 0;\n      iterable.__iterate(function(v, k)  {\n        if (!(isSkipping && (isSkipping = skipped++ < resolvedBegin))) {\n          iterations++;\n          return fn(v, useKeys ? k : iterations - 1, this$0) !== false &&\n                 iterations !== sliceSize;\n        }\n      });\n      return iterations;\n    };\n\n    sliceSeq.__iteratorUncached = function(type, reverse) {\n      if (sliceSize !== 0 && reverse) {\n        return this.cacheResult().__iterator(type, reverse);\n      }\n      // Don't bother instantiating parent iterator if taking 0.\n      var iterator = sliceSize !== 0 && iterable.__iterator(type, reverse);\n      var skipped = 0;\n      var iterations = 0;\n      return new Iterator(function()  {\n        while (skipped++ < resolvedBegin) {\n          iterator.next();\n        }\n        if (++iterations > sliceSize) {\n          return iteratorDone();\n        }\n        var step = iterator.next();\n        if (useKeys || type === ITERATE_VALUES) {\n          return step;\n        } else if (type === ITERATE_KEYS) {\n          return iteratorValue(type, iterations - 1, undefined, step);\n        } else {\n          return iteratorValue(type, iterations - 1, step.value[1], step);\n        }\n      });\n    }\n\n    return sliceSeq;\n  }\n\n\n  function takeWhileFactory(iterable, predicate, context) {\n    var takeSequence = makeSequence(iterable);\n    takeSequence.__iterateUncached = function(fn, reverse) {var this$0 = this;\n      if (reverse) {\n        return this.cacheResult().__iterate(fn, reverse);\n      }\n      var iterations = 0;\n      iterable.__iterate(function(v, k, c) \n        {return predicate.call(context, v, k, c) && ++iterations && fn(v, k, this$0)}\n      );\n      return iterations;\n    };\n    takeSequence.__iteratorUncached = function(type, reverse) {var this$0 = this;\n      if (reverse) {\n        return this.cacheResult().__iterator(type, reverse);\n      }\n      var iterator = iterable.__iterator(ITERATE_ENTRIES, reverse);\n      var iterating = true;\n      return new Iterator(function()  {\n        if (!iterating) {\n          return iteratorDone();\n        }\n        var step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n        var entry = step.value;\n        var k = entry[0];\n        var v = entry[1];\n        if (!predicate.call(context, v, k, this$0)) {\n          iterating = false;\n          return iteratorDone();\n        }\n        return type === ITERATE_ENTRIES ? step :\n          iteratorValue(type, k, v, step);\n      });\n    };\n    return takeSequence;\n  }\n\n\n  function skipWhileFactory(iterable, predicate, context, useKeys) {\n    var skipSequence = makeSequence(iterable);\n    skipSequence.__iterateUncached = function (fn, reverse) {var this$0 = this;\n      if (reverse) {\n        return this.cacheResult().__iterate(fn, reverse);\n      }\n      var isSkipping = true;\n      var iterations = 0;\n      iterable.__iterate(function(v, k, c)  {\n        if (!(isSkipping && (isSkipping = predicate.call(context, v, k, c)))) {\n          iterations++;\n          return fn(v, useKeys ? k : iterations - 1, this$0);\n        }\n      });\n      return iterations;\n    };\n    skipSequence.__iteratorUncached = function(type, reverse) {var this$0 = this;\n      if (reverse) {\n        return this.cacheResult().__iterator(type, reverse);\n      }\n      var iterator = iterable.__iterator(ITERATE_ENTRIES, reverse);\n      var skipping = true;\n      var iterations = 0;\n      return new Iterator(function()  {\n        var step, k, v;\n        do {\n          step = iterator.next();\n          if (step.done) {\n            if (useKeys || type === ITERATE_VALUES) {\n              return step;\n            } else if (type === ITERATE_KEYS) {\n              return iteratorValue(type, iterations++, undefined, step);\n            } else {\n              return iteratorValue(type, iterations++, step.value[1], step);\n            }\n          }\n          var entry = step.value;\n          k = entry[0];\n          v = entry[1];\n          skipping && (skipping = predicate.call(context, v, k, this$0));\n        } while (skipping);\n        return type === ITERATE_ENTRIES ? step :\n          iteratorValue(type, k, v, step);\n      });\n    };\n    return skipSequence;\n  }\n\n\n  function concatFactory(iterable, values) {\n    var isKeyedIterable = isKeyed(iterable);\n    var iters = [iterable].concat(values).map(function(v ) {\n      if (!isIterable(v)) {\n        v = isKeyedIterable ?\n          keyedSeqFromValue(v) :\n          indexedSeqFromValue(Array.isArray(v) ? v : [v]);\n      } else if (isKeyedIterable) {\n        v = KeyedIterable(v);\n      }\n      return v;\n    }).filter(function(v ) {return v.size !== 0});\n\n    if (iters.length === 0) {\n      return iterable;\n    }\n\n    if (iters.length === 1) {\n      var singleton = iters[0];\n      if (singleton === iterable ||\n          isKeyedIterable && isKeyed(singleton) ||\n          isIndexed(iterable) && isIndexed(singleton)) {\n        return singleton;\n      }\n    }\n\n    var concatSeq = new ArraySeq(iters);\n    if (isKeyedIterable) {\n      concatSeq = concatSeq.toKeyedSeq();\n    } else if (!isIndexed(iterable)) {\n      concatSeq = concatSeq.toSetSeq();\n    }\n    concatSeq = concatSeq.flatten(true);\n    concatSeq.size = iters.reduce(\n      function(sum, seq)  {\n        if (sum !== undefined) {\n          var size = seq.size;\n          if (size !== undefined) {\n            return sum + size;\n          }\n        }\n      },\n      0\n    );\n    return concatSeq;\n  }\n\n\n  function flattenFactory(iterable, depth, useKeys) {\n    var flatSequence = makeSequence(iterable);\n    flatSequence.__iterateUncached = function(fn, reverse) {\n      var iterations = 0;\n      var stopped = false;\n      function flatDeep(iter, currentDepth) {var this$0 = this;\n        iter.__iterate(function(v, k)  {\n          if ((!depth || currentDepth < depth) && isIterable(v)) {\n            flatDeep(v, currentDepth + 1);\n          } else if (fn(v, useKeys ? k : iterations++, this$0) === false) {\n            stopped = true;\n          }\n          return !stopped;\n        }, reverse);\n      }\n      flatDeep(iterable, 0);\n      return iterations;\n    }\n    flatSequence.__iteratorUncached = function(type, reverse) {\n      var iterator = iterable.__iterator(type, reverse);\n      var stack = [];\n      var iterations = 0;\n      return new Iterator(function()  {\n        while (iterator) {\n          var step = iterator.next();\n          if (step.done !== false) {\n            iterator = stack.pop();\n            continue;\n          }\n          var v = step.value;\n          if (type === ITERATE_ENTRIES) {\n            v = v[1];\n          }\n          if ((!depth || stack.length < depth) && isIterable(v)) {\n            stack.push(iterator);\n            iterator = v.__iterator(type, reverse);\n          } else {\n            return useKeys ? step : iteratorValue(type, iterations++, v, step);\n          }\n        }\n        return iteratorDone();\n      });\n    }\n    return flatSequence;\n  }\n\n\n  function flatMapFactory(iterable, mapper, context) {\n    var coerce = iterableClass(iterable);\n    return iterable.toSeq().map(\n      function(v, k)  {return coerce(mapper.call(context, v, k, iterable))}\n    ).flatten(true);\n  }\n\n\n  function interposeFactory(iterable, separator) {\n    var interposedSequence = makeSequence(iterable);\n    interposedSequence.size = iterable.size && iterable.size * 2 -1;\n    interposedSequence.__iterateUncached = function(fn, reverse) {var this$0 = this;\n      var iterations = 0;\n      iterable.__iterate(function(v, k) \n        {return (!iterations || fn(separator, iterations++, this$0) !== false) &&\n        fn(v, iterations++, this$0) !== false},\n        reverse\n      );\n      return iterations;\n    };\n    interposedSequence.__iteratorUncached = function(type, reverse) {\n      var iterator = iterable.__iterator(ITERATE_VALUES, reverse);\n      var iterations = 0;\n      var step;\n      return new Iterator(function()  {\n        if (!step || iterations % 2) {\n          step = iterator.next();\n          if (step.done) {\n            return step;\n          }\n        }\n        return iterations % 2 ?\n          iteratorValue(type, iterations++, separator) :\n          iteratorValue(type, iterations++, step.value, step);\n      });\n    };\n    return interposedSequence;\n  }\n\n\n  function sortFactory(iterable, comparator, mapper) {\n    if (!comparator) {\n      comparator = defaultComparator;\n    }\n    var isKeyedIterable = isKeyed(iterable);\n    var index = 0;\n    var entries = iterable.toSeq().map(\n      function(v, k)  {return [k, v, index++, mapper ? mapper(v, k, iterable) : v]}\n    ).toArray();\n    entries.sort(function(a, b)  {return comparator(a[3], b[3]) || a[2] - b[2]}).forEach(\n      isKeyedIterable ?\n      function(v, i)  { entries[i].length = 2; } :\n      function(v, i)  { entries[i] = v[1]; }\n    );\n    return isKeyedIterable ? KeyedSeq(entries) :\n      isIndexed(iterable) ? IndexedSeq(entries) :\n      SetSeq(entries);\n  }\n\n\n  function maxFactory(iterable, comparator, mapper) {\n    if (!comparator) {\n      comparator = defaultComparator;\n    }\n    if (mapper) {\n      var entry = iterable.toSeq()\n        .map(function(v, k)  {return [v, mapper(v, k, iterable)]})\n        .reduce(function(a, b)  {return maxCompare(comparator, a[1], b[1]) ? b : a});\n      return entry && entry[0];\n    } else {\n      return iterable.reduce(function(a, b)  {return maxCompare(comparator, a, b) ? b : a});\n    }\n  }\n\n  function maxCompare(comparator, a, b) {\n    var comp = comparator(b, a);\n    // b is considered the new max if the comparator declares them equal, but\n    // they are not equal and b is in fact a nullish value.\n    return (comp === 0 && b !== a && (b === undefined || b === null || b !== b)) || comp > 0;\n  }\n\n\n  function zipWithFactory(keyIter, zipper, iters) {\n    var zipSequence = makeSequence(keyIter);\n    zipSequence.size = new ArraySeq(iters).map(function(i ) {return i.size}).min();\n    // Note: this a generic base implementation of __iterate in terms of\n    // __iterator which may be more generically useful in the future.\n    zipSequence.__iterate = function(fn, reverse) {\n      /* generic:\n      var iterator = this.__iterator(ITERATE_ENTRIES, reverse);\n      var step;\n      var iterations = 0;\n      while (!(step = iterator.next()).done) {\n        iterations++;\n        if (fn(step.value[1], step.value[0], this) === false) {\n          break;\n        }\n      }\n      return iterations;\n      */\n      // indexed:\n      var iterator = this.__iterator(ITERATE_VALUES, reverse);\n      var step;\n      var iterations = 0;\n      while (!(step = iterator.next()).done) {\n        if (fn(step.value, iterations++, this) === false) {\n          break;\n        }\n      }\n      return iterations;\n    };\n    zipSequence.__iteratorUncached = function(type, reverse) {\n      var iterators = iters.map(function(i )\n        {return (i = Iterable(i), getIterator(reverse ? i.reverse() : i))}\n      );\n      var iterations = 0;\n      var isDone = false;\n      return new Iterator(function()  {\n        var steps;\n        if (!isDone) {\n          steps = iterators.map(function(i ) {return i.next()});\n          isDone = steps.some(function(s ) {return s.done});\n        }\n        if (isDone) {\n          return iteratorDone();\n        }\n        return iteratorValue(\n          type,\n          iterations++,\n          zipper.apply(null, steps.map(function(s ) {return s.value}))\n        );\n      });\n    };\n    return zipSequence\n  }\n\n\n  // #pragma Helper Functions\n\n  function reify(iter, seq) {\n    return isSeq(iter) ? seq : iter.constructor(seq);\n  }\n\n  function validateEntry(entry) {\n    if (entry !== Object(entry)) {\n      throw new TypeError('Expected [K, V] tuple: ' + entry);\n    }\n  }\n\n  function resolveSize(iter) {\n    assertNotInfinite(iter.size);\n    return ensureSize(iter);\n  }\n\n  function iterableClass(iterable) {\n    return isKeyed(iterable) ? KeyedIterable :\n      isIndexed(iterable) ? IndexedIterable :\n      SetIterable;\n  }\n\n  function makeSequence(iterable) {\n    return Object.create(\n      (\n        isKeyed(iterable) ? KeyedSeq :\n        isIndexed(iterable) ? IndexedSeq :\n        SetSeq\n      ).prototype\n    );\n  }\n\n  function cacheResultThrough() {\n    if (this._iter.cacheResult) {\n      this._iter.cacheResult();\n      this.size = this._iter.size;\n      return this;\n    } else {\n      return Seq.prototype.cacheResult.call(this);\n    }\n  }\n\n  function defaultComparator(a, b) {\n    return a > b ? 1 : a < b ? -1 : 0;\n  }\n\n  function forceIterator(keyPath) {\n    var iter = getIterator(keyPath);\n    if (!iter) {\n      // Array might not be iterable in this environment, so we need a fallback\n      // to our wrapped type.\n      if (!isArrayLike(keyPath)) {\n        throw new TypeError('Expected iterable or array-like: ' + keyPath);\n      }\n      iter = getIterator(Iterable(keyPath));\n    }\n    return iter;\n  }\n\n  createClass(Record, KeyedCollection);\n\n    function Record(defaultValues, name) {\n      var hasInitialized;\n\n      var RecordType = function Record(values) {\n        if (values instanceof RecordType) {\n          return values;\n        }\n        if (!(this instanceof RecordType)) {\n          return new RecordType(values);\n        }\n        if (!hasInitialized) {\n          hasInitialized = true;\n          var keys = Object.keys(defaultValues);\n          setProps(RecordTypePrototype, keys);\n          RecordTypePrototype.size = keys.length;\n          RecordTypePrototype._name = name;\n          RecordTypePrototype._keys = keys;\n          RecordTypePrototype._defaultValues = defaultValues;\n        }\n        this._map = Map(values);\n      };\n\n      var RecordTypePrototype = RecordType.prototype = Object.create(RecordPrototype);\n      RecordTypePrototype.constructor = RecordType;\n\n      return RecordType;\n    }\n\n    Record.prototype.toString = function() {\n      return this.__toString(recordName(this) + ' {', '}');\n    };\n\n    // @pragma Access\n\n    Record.prototype.has = function(k) {\n      return this._defaultValues.hasOwnProperty(k);\n    };\n\n    Record.prototype.get = function(k, notSetValue) {\n      if (!this.has(k)) {\n        return notSetValue;\n      }\n      var defaultVal = this._defaultValues[k];\n      return this._map ? this._map.get(k, defaultVal) : defaultVal;\n    };\n\n    // @pragma Modification\n\n    Record.prototype.clear = function() {\n      if (this.__ownerID) {\n        this._map && this._map.clear();\n        return this;\n      }\n      var RecordType = this.constructor;\n      return RecordType._empty || (RecordType._empty = makeRecord(this, emptyMap()));\n    };\n\n    Record.prototype.set = function(k, v) {\n      if (!this.has(k)) {\n        throw new Error('Cannot set unknown key \"' + k + '\" on ' + recordName(this));\n      }\n      if (this._map && !this._map.has(k)) {\n        var defaultVal = this._defaultValues[k];\n        if (v === defaultVal) {\n          return this;\n        }\n      }\n      var newMap = this._map && this._map.set(k, v);\n      if (this.__ownerID || newMap === this._map) {\n        return this;\n      }\n      return makeRecord(this, newMap);\n    };\n\n    Record.prototype.remove = function(k) {\n      if (!this.has(k)) {\n        return this;\n      }\n      var newMap = this._map && this._map.remove(k);\n      if (this.__ownerID || newMap === this._map) {\n        return this;\n      }\n      return makeRecord(this, newMap);\n    };\n\n    Record.prototype.wasAltered = function() {\n      return this._map.wasAltered();\n    };\n\n    Record.prototype.__iterator = function(type, reverse) {var this$0 = this;\n      return KeyedIterable(this._defaultValues).map(function(_, k)  {return this$0.get(k)}).__iterator(type, reverse);\n    };\n\n    Record.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      return KeyedIterable(this._defaultValues).map(function(_, k)  {return this$0.get(k)}).__iterate(fn, reverse);\n    };\n\n    Record.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      var newMap = this._map && this._map.__ensureOwner(ownerID);\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        this._map = newMap;\n        return this;\n      }\n      return makeRecord(this, newMap, ownerID);\n    };\n\n\n  var RecordPrototype = Record.prototype;\n  RecordPrototype[DELETE] = RecordPrototype.remove;\n  RecordPrototype.deleteIn =\n  RecordPrototype.removeIn = MapPrototype.removeIn;\n  RecordPrototype.merge = MapPrototype.merge;\n  RecordPrototype.mergeWith = MapPrototype.mergeWith;\n  RecordPrototype.mergeIn = MapPrototype.mergeIn;\n  RecordPrototype.mergeDeep = MapPrototype.mergeDeep;\n  RecordPrototype.mergeDeepWith = MapPrototype.mergeDeepWith;\n  RecordPrototype.mergeDeepIn = MapPrototype.mergeDeepIn;\n  RecordPrototype.setIn = MapPrototype.setIn;\n  RecordPrototype.update = MapPrototype.update;\n  RecordPrototype.updateIn = MapPrototype.updateIn;\n  RecordPrototype.withMutations = MapPrototype.withMutations;\n  RecordPrototype.asMutable = MapPrototype.asMutable;\n  RecordPrototype.asImmutable = MapPrototype.asImmutable;\n\n\n  function makeRecord(likeRecord, map, ownerID) {\n    var record = Object.create(Object.getPrototypeOf(likeRecord));\n    record._map = map;\n    record.__ownerID = ownerID;\n    return record;\n  }\n\n  function recordName(record) {\n    return record._name || record.constructor.name || 'Record';\n  }\n\n  function setProps(prototype, names) {\n    try {\n      names.forEach(setProp.bind(undefined, prototype));\n    } catch (error) {\n      // Object.defineProperty failed. Probably IE8.\n    }\n  }\n\n  function setProp(prototype, name) {\n    Object.defineProperty(prototype, name, {\n      get: function() {\n        return this.get(name);\n      },\n      set: function(value) {\n        invariant(this.__ownerID, 'Cannot set on an immutable record.');\n        this.set(name, value);\n      }\n    });\n  }\n\n  createClass(Set, SetCollection);\n\n    // @pragma Construction\n\n    function Set(value) {\n      return value === null || value === undefined ? emptySet() :\n        isSet(value) && !isOrdered(value) ? value :\n        emptySet().withMutations(function(set ) {\n          var iter = SetIterable(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function(v ) {return set.add(v)});\n        });\n    }\n\n    Set.of = function(/*...values*/) {\n      return this(arguments);\n    };\n\n    Set.fromKeys = function(value) {\n      return this(KeyedIterable(value).keySeq());\n    };\n\n    Set.prototype.toString = function() {\n      return this.__toString('Set {', '}');\n    };\n\n    // @pragma Access\n\n    Set.prototype.has = function(value) {\n      return this._map.has(value);\n    };\n\n    // @pragma Modification\n\n    Set.prototype.add = function(value) {\n      return updateSet(this, this._map.set(value, true));\n    };\n\n    Set.prototype.remove = function(value) {\n      return updateSet(this, this._map.remove(value));\n    };\n\n    Set.prototype.clear = function() {\n      return updateSet(this, this._map.clear());\n    };\n\n    // @pragma Composition\n\n    Set.prototype.union = function() {var iters = SLICE$0.call(arguments, 0);\n      iters = iters.filter(function(x ) {return x.size !== 0});\n      if (iters.length === 0) {\n        return this;\n      }\n      if (this.size === 0 && !this.__ownerID && iters.length === 1) {\n        return this.constructor(iters[0]);\n      }\n      return this.withMutations(function(set ) {\n        for (var ii = 0; ii < iters.length; ii++) {\n          SetIterable(iters[ii]).forEach(function(value ) {return set.add(value)});\n        }\n      });\n    };\n\n    Set.prototype.intersect = function() {var iters = SLICE$0.call(arguments, 0);\n      if (iters.length === 0) {\n        return this;\n      }\n      iters = iters.map(function(iter ) {return SetIterable(iter)});\n      var originalSet = this;\n      return this.withMutations(function(set ) {\n        originalSet.forEach(function(value ) {\n          if (!iters.every(function(iter ) {return iter.includes(value)})) {\n            set.remove(value);\n          }\n        });\n      });\n    };\n\n    Set.prototype.subtract = function() {var iters = SLICE$0.call(arguments, 0);\n      if (iters.length === 0) {\n        return this;\n      }\n      iters = iters.map(function(iter ) {return SetIterable(iter)});\n      var originalSet = this;\n      return this.withMutations(function(set ) {\n        originalSet.forEach(function(value ) {\n          if (iters.some(function(iter ) {return iter.includes(value)})) {\n            set.remove(value);\n          }\n        });\n      });\n    };\n\n    Set.prototype.merge = function() {\n      return this.union.apply(this, arguments);\n    };\n\n    Set.prototype.mergeWith = function(merger) {var iters = SLICE$0.call(arguments, 1);\n      return this.union.apply(this, iters);\n    };\n\n    Set.prototype.sort = function(comparator) {\n      // Late binding\n      return OrderedSet(sortFactory(this, comparator));\n    };\n\n    Set.prototype.sortBy = function(mapper, comparator) {\n      // Late binding\n      return OrderedSet(sortFactory(this, comparator, mapper));\n    };\n\n    Set.prototype.wasAltered = function() {\n      return this._map.wasAltered();\n    };\n\n    Set.prototype.__iterate = function(fn, reverse) {var this$0 = this;\n      return this._map.__iterate(function(_, k)  {return fn(k, k, this$0)}, reverse);\n    };\n\n    Set.prototype.__iterator = function(type, reverse) {\n      return this._map.map(function(_, k)  {return k}).__iterator(type, reverse);\n    };\n\n    Set.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      var newMap = this._map.__ensureOwner(ownerID);\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        this._map = newMap;\n        return this;\n      }\n      return this.__make(newMap, ownerID);\n    };\n\n\n  function isSet(maybeSet) {\n    return !!(maybeSet && maybeSet[IS_SET_SENTINEL]);\n  }\n\n  Set.isSet = isSet;\n\n  var IS_SET_SENTINEL = '@@__IMMUTABLE_SET__@@';\n\n  var SetPrototype = Set.prototype;\n  SetPrototype[IS_SET_SENTINEL] = true;\n  SetPrototype[DELETE] = SetPrototype.remove;\n  SetPrototype.mergeDeep = SetPrototype.merge;\n  SetPrototype.mergeDeepWith = SetPrototype.mergeWith;\n  SetPrototype.withMutations = MapPrototype.withMutations;\n  SetPrototype.asMutable = MapPrototype.asMutable;\n  SetPrototype.asImmutable = MapPrototype.asImmutable;\n\n  SetPrototype.__empty = emptySet;\n  SetPrototype.__make = makeSet;\n\n  function updateSet(set, newMap) {\n    if (set.__ownerID) {\n      set.size = newMap.size;\n      set._map = newMap;\n      return set;\n    }\n    return newMap === set._map ? set :\n      newMap.size === 0 ? set.__empty() :\n      set.__make(newMap);\n  }\n\n  function makeSet(map, ownerID) {\n    var set = Object.create(SetPrototype);\n    set.size = map ? map.size : 0;\n    set._map = map;\n    set.__ownerID = ownerID;\n    return set;\n  }\n\n  var EMPTY_SET;\n  function emptySet() {\n    return EMPTY_SET || (EMPTY_SET = makeSet(emptyMap()));\n  }\n\n  createClass(OrderedSet, Set);\n\n    // @pragma Construction\n\n    function OrderedSet(value) {\n      return value === null || value === undefined ? emptyOrderedSet() :\n        isOrderedSet(value) ? value :\n        emptyOrderedSet().withMutations(function(set ) {\n          var iter = SetIterable(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function(v ) {return set.add(v)});\n        });\n    }\n\n    OrderedSet.of = function(/*...values*/) {\n      return this(arguments);\n    };\n\n    OrderedSet.fromKeys = function(value) {\n      return this(KeyedIterable(value).keySeq());\n    };\n\n    OrderedSet.prototype.toString = function() {\n      return this.__toString('OrderedSet {', '}');\n    };\n\n\n  function isOrderedSet(maybeOrderedSet) {\n    return isSet(maybeOrderedSet) && isOrdered(maybeOrderedSet);\n  }\n\n  OrderedSet.isOrderedSet = isOrderedSet;\n\n  var OrderedSetPrototype = OrderedSet.prototype;\n  OrderedSetPrototype[IS_ORDERED_SENTINEL] = true;\n\n  OrderedSetPrototype.__empty = emptyOrderedSet;\n  OrderedSetPrototype.__make = makeOrderedSet;\n\n  function makeOrderedSet(map, ownerID) {\n    var set = Object.create(OrderedSetPrototype);\n    set.size = map ? map.size : 0;\n    set._map = map;\n    set.__ownerID = ownerID;\n    return set;\n  }\n\n  var EMPTY_ORDERED_SET;\n  function emptyOrderedSet() {\n    return EMPTY_ORDERED_SET || (EMPTY_ORDERED_SET = makeOrderedSet(emptyOrderedMap()));\n  }\n\n  createClass(Stack, IndexedCollection);\n\n    // @pragma Construction\n\n    function Stack(value) {\n      return value === null || value === undefined ? emptyStack() :\n        isStack(value) ? value :\n        emptyStack().unshiftAll(value);\n    }\n\n    Stack.of = function(/*...values*/) {\n      return this(arguments);\n    };\n\n    Stack.prototype.toString = function() {\n      return this.__toString('Stack [', ']');\n    };\n\n    // @pragma Access\n\n    Stack.prototype.get = function(index, notSetValue) {\n      var head = this._head;\n      index = wrapIndex(this, index);\n      while (head && index--) {\n        head = head.next;\n      }\n      return head ? head.value : notSetValue;\n    };\n\n    Stack.prototype.peek = function() {\n      return this._head && this._head.value;\n    };\n\n    // @pragma Modification\n\n    Stack.prototype.push = function(/*...values*/) {\n      if (arguments.length === 0) {\n        return this;\n      }\n      var newSize = this.size + arguments.length;\n      var head = this._head;\n      for (var ii = arguments.length - 1; ii >= 0; ii--) {\n        head = {\n          value: arguments[ii],\n          next: head\n        };\n      }\n      if (this.__ownerID) {\n        this.size = newSize;\n        this._head = head;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return makeStack(newSize, head);\n    };\n\n    Stack.prototype.pushAll = function(iter) {\n      iter = IndexedIterable(iter);\n      if (iter.size === 0) {\n        return this;\n      }\n      assertNotInfinite(iter.size);\n      var newSize = this.size;\n      var head = this._head;\n      iter.reverse().forEach(function(value ) {\n        newSize++;\n        head = {\n          value: value,\n          next: head\n        };\n      });\n      if (this.__ownerID) {\n        this.size = newSize;\n        this._head = head;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return makeStack(newSize, head);\n    };\n\n    Stack.prototype.pop = function() {\n      return this.slice(1);\n    };\n\n    Stack.prototype.unshift = function(/*...values*/) {\n      return this.push.apply(this, arguments);\n    };\n\n    Stack.prototype.unshiftAll = function(iter) {\n      return this.pushAll(iter);\n    };\n\n    Stack.prototype.shift = function() {\n      return this.pop.apply(this, arguments);\n    };\n\n    Stack.prototype.clear = function() {\n      if (this.size === 0) {\n        return this;\n      }\n      if (this.__ownerID) {\n        this.size = 0;\n        this._head = undefined;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return emptyStack();\n    };\n\n    Stack.prototype.slice = function(begin, end) {\n      if (wholeSlice(begin, end, this.size)) {\n        return this;\n      }\n      var resolvedBegin = resolveBegin(begin, this.size);\n      var resolvedEnd = resolveEnd(end, this.size);\n      if (resolvedEnd !== this.size) {\n        // super.slice(begin, end);\n        return IndexedCollection.prototype.slice.call(this, begin, end);\n      }\n      var newSize = this.size - resolvedBegin;\n      var head = this._head;\n      while (resolvedBegin--) {\n        head = head.next;\n      }\n      if (this.__ownerID) {\n        this.size = newSize;\n        this._head = head;\n        this.__hash = undefined;\n        this.__altered = true;\n        return this;\n      }\n      return makeStack(newSize, head);\n    };\n\n    // @pragma Mutability\n\n    Stack.prototype.__ensureOwner = function(ownerID) {\n      if (ownerID === this.__ownerID) {\n        return this;\n      }\n      if (!ownerID) {\n        this.__ownerID = ownerID;\n        this.__altered = false;\n        return this;\n      }\n      return makeStack(this.size, this._head, ownerID, this.__hash);\n    };\n\n    // @pragma Iteration\n\n    Stack.prototype.__iterate = function(fn, reverse) {\n      if (reverse) {\n        return this.reverse().__iterate(fn);\n      }\n      var iterations = 0;\n      var node = this._head;\n      while (node) {\n        if (fn(node.value, iterations++, this) === false) {\n          break;\n        }\n        node = node.next;\n      }\n      return iterations;\n    };\n\n    Stack.prototype.__iterator = function(type, reverse) {\n      if (reverse) {\n        return this.reverse().__iterator(type);\n      }\n      var iterations = 0;\n      var node = this._head;\n      return new Iterator(function()  {\n        if (node) {\n          var value = node.value;\n          node = node.next;\n          return iteratorValue(type, iterations++, value);\n        }\n        return iteratorDone();\n      });\n    };\n\n\n  function isStack(maybeStack) {\n    return !!(maybeStack && maybeStack[IS_STACK_SENTINEL]);\n  }\n\n  Stack.isStack = isStack;\n\n  var IS_STACK_SENTINEL = '@@__IMMUTABLE_STACK__@@';\n\n  var StackPrototype = Stack.prototype;\n  StackPrototype[IS_STACK_SENTINEL] = true;\n  StackPrototype.withMutations = MapPrototype.withMutations;\n  StackPrototype.asMutable = MapPrototype.asMutable;\n  StackPrototype.asImmutable = MapPrototype.asImmutable;\n  StackPrototype.wasAltered = MapPrototype.wasAltered;\n\n\n  function makeStack(size, head, ownerID, hash) {\n    var map = Object.create(StackPrototype);\n    map.size = size;\n    map._head = head;\n    map.__ownerID = ownerID;\n    map.__hash = hash;\n    map.__altered = false;\n    return map;\n  }\n\n  var EMPTY_STACK;\n  function emptyStack() {\n    return EMPTY_STACK || (EMPTY_STACK = makeStack(0));\n  }\n\n  /**\n   * Contributes additional methods to a constructor\n   */\n  function mixin(ctor, methods) {\n    var keyCopier = function(key ) { ctor.prototype[key] = methods[key]; };\n    Object.keys(methods).forEach(keyCopier);\n    Object.getOwnPropertySymbols &&\n      Object.getOwnPropertySymbols(methods).forEach(keyCopier);\n    return ctor;\n  }\n\n  Iterable.Iterator = Iterator;\n\n  mixin(Iterable, {\n\n    // ### Conversion to other types\n\n    toArray: function() {\n      assertNotInfinite(this.size);\n      var array = new Array(this.size || 0);\n      this.valueSeq().__iterate(function(v, i)  { array[i] = v; });\n      return array;\n    },\n\n    toIndexedSeq: function() {\n      return new ToIndexedSequence(this);\n    },\n\n    toJS: function() {\n      return this.toSeq().map(\n        function(value ) {return value && typeof value.toJS === 'function' ? value.toJS() : value}\n      ).__toJS();\n    },\n\n    toJSON: function() {\n      return this.toSeq().map(\n        function(value ) {return value && typeof value.toJSON === 'function' ? value.toJSON() : value}\n      ).__toJS();\n    },\n\n    toKeyedSeq: function() {\n      return new ToKeyedSequence(this, true);\n    },\n\n    toMap: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return Map(this.toKeyedSeq());\n    },\n\n    toObject: function() {\n      assertNotInfinite(this.size);\n      var object = {};\n      this.__iterate(function(v, k)  { object[k] = v; });\n      return object;\n    },\n\n    toOrderedMap: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return OrderedMap(this.toKeyedSeq());\n    },\n\n    toOrderedSet: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return OrderedSet(isKeyed(this) ? this.valueSeq() : this);\n    },\n\n    toSet: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return Set(isKeyed(this) ? this.valueSeq() : this);\n    },\n\n    toSetSeq: function() {\n      return new ToSetSequence(this);\n    },\n\n    toSeq: function() {\n      return isIndexed(this) ? this.toIndexedSeq() :\n        isKeyed(this) ? this.toKeyedSeq() :\n        this.toSetSeq();\n    },\n\n    toStack: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return Stack(isKeyed(this) ? this.valueSeq() : this);\n    },\n\n    toList: function() {\n      // Use Late Binding here to solve the circular dependency.\n      return List(isKeyed(this) ? this.valueSeq() : this);\n    },\n\n\n    // ### Common JavaScript methods and properties\n\n    toString: function() {\n      return '[Iterable]';\n    },\n\n    __toString: function(head, tail) {\n      if (this.size === 0) {\n        return head + tail;\n      }\n      return head + ' ' + this.toSeq().map(this.__toStringMapper).join(', ') + ' ' + tail;\n    },\n\n\n    // ### ES6 Collection methods (ES6 Array and Map)\n\n    concat: function() {var values = SLICE$0.call(arguments, 0);\n      return reify(this, concatFactory(this, values));\n    },\n\n    includes: function(searchValue) {\n      return this.some(function(value ) {return is(value, searchValue)});\n    },\n\n    entries: function() {\n      return this.__iterator(ITERATE_ENTRIES);\n    },\n\n    every: function(predicate, context) {\n      assertNotInfinite(this.size);\n      var returnValue = true;\n      this.__iterate(function(v, k, c)  {\n        if (!predicate.call(context, v, k, c)) {\n          returnValue = false;\n          return false;\n        }\n      });\n      return returnValue;\n    },\n\n    filter: function(predicate, context) {\n      return reify(this, filterFactory(this, predicate, context, true));\n    },\n\n    find: function(predicate, context, notSetValue) {\n      var entry = this.findEntry(predicate, context);\n      return entry ? entry[1] : notSetValue;\n    },\n\n    forEach: function(sideEffect, context) {\n      assertNotInfinite(this.size);\n      return this.__iterate(context ? sideEffect.bind(context) : sideEffect);\n    },\n\n    join: function(separator) {\n      assertNotInfinite(this.size);\n      separator = separator !== undefined ? '' + separator : ',';\n      var joined = '';\n      var isFirst = true;\n      this.__iterate(function(v ) {\n        isFirst ? (isFirst = false) : (joined += separator);\n        joined += v !== null && v !== undefined ? v.toString() : '';\n      });\n      return joined;\n    },\n\n    keys: function() {\n      return this.__iterator(ITERATE_KEYS);\n    },\n\n    map: function(mapper, context) {\n      return reify(this, mapFactory(this, mapper, context));\n    },\n\n    reduce: function(reducer, initialReduction, context) {\n      assertNotInfinite(this.size);\n      var reduction;\n      var useFirst;\n      if (arguments.length < 2) {\n        useFirst = true;\n      } else {\n        reduction = initialReduction;\n      }\n      this.__iterate(function(v, k, c)  {\n        if (useFirst) {\n          useFirst = false;\n          reduction = v;\n        } else {\n          reduction = reducer.call(context, reduction, v, k, c);\n        }\n      });\n      return reduction;\n    },\n\n    reduceRight: function(reducer, initialReduction, context) {\n      var reversed = this.toKeyedSeq().reverse();\n      return reversed.reduce.apply(reversed, arguments);\n    },\n\n    reverse: function() {\n      return reify(this, reverseFactory(this, true));\n    },\n\n    slice: function(begin, end) {\n      return reify(this, sliceFactory(this, begin, end, true));\n    },\n\n    some: function(predicate, context) {\n      return !this.every(not(predicate), context);\n    },\n\n    sort: function(comparator) {\n      return reify(this, sortFactory(this, comparator));\n    },\n\n    values: function() {\n      return this.__iterator(ITERATE_VALUES);\n    },\n\n\n    // ### More sequential methods\n\n    butLast: function() {\n      return this.slice(0, -1);\n    },\n\n    isEmpty: function() {\n      return this.size !== undefined ? this.size === 0 : !this.some(function()  {return true});\n    },\n\n    count: function(predicate, context) {\n      return ensureSize(\n        predicate ? this.toSeq().filter(predicate, context) : this\n      );\n    },\n\n    countBy: function(grouper, context) {\n      return countByFactory(this, grouper, context);\n    },\n\n    equals: function(other) {\n      return deepEqual(this, other);\n    },\n\n    entrySeq: function() {\n      var iterable = this;\n      if (iterable._cache) {\n        // We cache as an entries array, so we can just return the cache!\n        return new ArraySeq(iterable._cache);\n      }\n      var entriesSequence = iterable.toSeq().map(entryMapper).toIndexedSeq();\n      entriesSequence.fromEntrySeq = function()  {return iterable.toSeq()};\n      return entriesSequence;\n    },\n\n    filterNot: function(predicate, context) {\n      return this.filter(not(predicate), context);\n    },\n\n    findEntry: function(predicate, context, notSetValue) {\n      var found = notSetValue;\n      this.__iterate(function(v, k, c)  {\n        if (predicate.call(context, v, k, c)) {\n          found = [k, v];\n          return false;\n        }\n      });\n      return found;\n    },\n\n    findKey: function(predicate, context) {\n      var entry = this.findEntry(predicate, context);\n      return entry && entry[0];\n    },\n\n    findLast: function(predicate, context, notSetValue) {\n      return this.toKeyedSeq().reverse().find(predicate, context, notSetValue);\n    },\n\n    findLastEntry: function(predicate, context, notSetValue) {\n      return this.toKeyedSeq().reverse().findEntry(predicate, context, notSetValue);\n    },\n\n    findLastKey: function(predicate, context) {\n      return this.toKeyedSeq().reverse().findKey(predicate, context);\n    },\n\n    first: function() {\n      return this.find(returnTrue);\n    },\n\n    flatMap: function(mapper, context) {\n      return reify(this, flatMapFactory(this, mapper, context));\n    },\n\n    flatten: function(depth) {\n      return reify(this, flattenFactory(this, depth, true));\n    },\n\n    fromEntrySeq: function() {\n      return new FromEntriesSequence(this);\n    },\n\n    get: function(searchKey, notSetValue) {\n      return this.find(function(_, key)  {return is(key, searchKey)}, undefined, notSetValue);\n    },\n\n    getIn: function(searchKeyPath, notSetValue) {\n      var nested = this;\n      // Note: in an ES6 environment, we would prefer:\n      // for (var key of searchKeyPath) {\n      var iter = forceIterator(searchKeyPath);\n      var step;\n      while (!(step = iter.next()).done) {\n        var key = step.value;\n        nested = nested && nested.get ? nested.get(key, NOT_SET) : NOT_SET;\n        if (nested === NOT_SET) {\n          return notSetValue;\n        }\n      }\n      return nested;\n    },\n\n    groupBy: function(grouper, context) {\n      return groupByFactory(this, grouper, context);\n    },\n\n    has: function(searchKey) {\n      return this.get(searchKey, NOT_SET) !== NOT_SET;\n    },\n\n    hasIn: function(searchKeyPath) {\n      return this.getIn(searchKeyPath, NOT_SET) !== NOT_SET;\n    },\n\n    isSubset: function(iter) {\n      iter = typeof iter.includes === 'function' ? iter : Iterable(iter);\n      return this.every(function(value ) {return iter.includes(value)});\n    },\n\n    isSuperset: function(iter) {\n      iter = typeof iter.isSubset === 'function' ? iter : Iterable(iter);\n      return iter.isSubset(this);\n    },\n\n    keyOf: function(searchValue) {\n      return this.findKey(function(value ) {return is(value, searchValue)});\n    },\n\n    keySeq: function() {\n      return this.toSeq().map(keyMapper).toIndexedSeq();\n    },\n\n    last: function() {\n      return this.toSeq().reverse().first();\n    },\n\n    lastKeyOf: function(searchValue) {\n      return this.toKeyedSeq().reverse().keyOf(searchValue);\n    },\n\n    max: function(comparator) {\n      return maxFactory(this, comparator);\n    },\n\n    maxBy: function(mapper, comparator) {\n      return maxFactory(this, comparator, mapper);\n    },\n\n    min: function(comparator) {\n      return maxFactory(this, comparator ? neg(comparator) : defaultNegComparator);\n    },\n\n    minBy: function(mapper, comparator) {\n      return maxFactory(this, comparator ? neg(comparator) : defaultNegComparator, mapper);\n    },\n\n    rest: function() {\n      return this.slice(1);\n    },\n\n    skip: function(amount) {\n      return this.slice(Math.max(0, amount));\n    },\n\n    skipLast: function(amount) {\n      return reify(this, this.toSeq().reverse().skip(amount).reverse());\n    },\n\n    skipWhile: function(predicate, context) {\n      return reify(this, skipWhileFactory(this, predicate, context, true));\n    },\n\n    skipUntil: function(predicate, context) {\n      return this.skipWhile(not(predicate), context);\n    },\n\n    sortBy: function(mapper, comparator) {\n      return reify(this, sortFactory(this, comparator, mapper));\n    },\n\n    take: function(amount) {\n      return this.slice(0, Math.max(0, amount));\n    },\n\n    takeLast: function(amount) {\n      return reify(this, this.toSeq().reverse().take(amount).reverse());\n    },\n\n    takeWhile: function(predicate, context) {\n      return reify(this, takeWhileFactory(this, predicate, context));\n    },\n\n    takeUntil: function(predicate, context) {\n      return this.takeWhile(not(predicate), context);\n    },\n\n    valueSeq: function() {\n      return this.toIndexedSeq();\n    },\n\n\n    // ### Hashable Object\n\n    hashCode: function() {\n      return this.__hash || (this.__hash = hashIterable(this));\n    }\n\n\n    // ### Internal\n\n    // abstract __iterate(fn, reverse)\n\n    // abstract __iterator(type, reverse)\n  });\n\n  // var IS_ITERABLE_SENTINEL = '@@__IMMUTABLE_ITERABLE__@@';\n  // var IS_KEYED_SENTINEL = '@@__IMMUTABLE_KEYED__@@';\n  // var IS_INDEXED_SENTINEL = '@@__IMMUTABLE_INDEXED__@@';\n  // var IS_ORDERED_SENTINEL = '@@__IMMUTABLE_ORDERED__@@';\n\n  var IterablePrototype = Iterable.prototype;\n  IterablePrototype[IS_ITERABLE_SENTINEL] = true;\n  IterablePrototype[ITERATOR_SYMBOL] = IterablePrototype.values;\n  IterablePrototype.__toJS = IterablePrototype.toArray;\n  IterablePrototype.__toStringMapper = quoteString;\n  IterablePrototype.inspect =\n  IterablePrototype.toSource = function() { return this.toString(); };\n  IterablePrototype.chain = IterablePrototype.flatMap;\n  IterablePrototype.contains = IterablePrototype.includes;\n\n  mixin(KeyedIterable, {\n\n    // ### More sequential methods\n\n    flip: function() {\n      return reify(this, flipFactory(this));\n    },\n\n    mapEntries: function(mapper, context) {var this$0 = this;\n      var iterations = 0;\n      return reify(this,\n        this.toSeq().map(\n          function(v, k)  {return mapper.call(context, [k, v], iterations++, this$0)}\n        ).fromEntrySeq()\n      );\n    },\n\n    mapKeys: function(mapper, context) {var this$0 = this;\n      return reify(this,\n        this.toSeq().flip().map(\n          function(k, v)  {return mapper.call(context, k, v, this$0)}\n        ).flip()\n      );\n    }\n\n  });\n\n  var KeyedIterablePrototype = KeyedIterable.prototype;\n  KeyedIterablePrototype[IS_KEYED_SENTINEL] = true;\n  KeyedIterablePrototype[ITERATOR_SYMBOL] = IterablePrototype.entries;\n  KeyedIterablePrototype.__toJS = IterablePrototype.toObject;\n  KeyedIterablePrototype.__toStringMapper = function(v, k)  {return JSON.stringify(k) + ': ' + quoteString(v)};\n\n\n\n  mixin(IndexedIterable, {\n\n    // ### Conversion to other types\n\n    toKeyedSeq: function() {\n      return new ToKeyedSequence(this, false);\n    },\n\n\n    // ### ES6 Collection methods (ES6 Array and Map)\n\n    filter: function(predicate, context) {\n      return reify(this, filterFactory(this, predicate, context, false));\n    },\n\n    findIndex: function(predicate, context) {\n      var entry = this.findEntry(predicate, context);\n      return entry ? entry[0] : -1;\n    },\n\n    indexOf: function(searchValue) {\n      var key = this.keyOf(searchValue);\n      return key === undefined ? -1 : key;\n    },\n\n    lastIndexOf: function(searchValue) {\n      var key = this.lastKeyOf(searchValue);\n      return key === undefined ? -1 : key;\n    },\n\n    reverse: function() {\n      return reify(this, reverseFactory(this, false));\n    },\n\n    slice: function(begin, end) {\n      return reify(this, sliceFactory(this, begin, end, false));\n    },\n\n    splice: function(index, removeNum /*, ...values*/) {\n      var numArgs = arguments.length;\n      removeNum = Math.max(removeNum | 0, 0);\n      if (numArgs === 0 || (numArgs === 2 && !removeNum)) {\n        return this;\n      }\n      // If index is negative, it should resolve relative to the size of the\n      // collection. However size may be expensive to compute if not cached, so\n      // only call count() if the number is in fact negative.\n      index = resolveBegin(index, index < 0 ? this.count() : this.size);\n      var spliced = this.slice(0, index);\n      return reify(\n        this,\n        numArgs === 1 ?\n          spliced :\n          spliced.concat(arrCopy(arguments, 2), this.slice(index + removeNum))\n      );\n    },\n\n\n    // ### More collection methods\n\n    findLastIndex: function(predicate, context) {\n      var entry = this.findLastEntry(predicate, context);\n      return entry ? entry[0] : -1;\n    },\n\n    first: function() {\n      return this.get(0);\n    },\n\n    flatten: function(depth) {\n      return reify(this, flattenFactory(this, depth, false));\n    },\n\n    get: function(index, notSetValue) {\n      index = wrapIndex(this, index);\n      return (index < 0 || (this.size === Infinity ||\n          (this.size !== undefined && index > this.size))) ?\n        notSetValue :\n        this.find(function(_, key)  {return key === index}, undefined, notSetValue);\n    },\n\n    has: function(index) {\n      index = wrapIndex(this, index);\n      return index >= 0 && (this.size !== undefined ?\n        this.size === Infinity || index < this.size :\n        this.indexOf(index) !== -1\n      );\n    },\n\n    interpose: function(separator) {\n      return reify(this, interposeFactory(this, separator));\n    },\n\n    interleave: function(/*...iterables*/) {\n      var iterables = [this].concat(arrCopy(arguments));\n      var zipped = zipWithFactory(this.toSeq(), IndexedSeq.of, iterables);\n      var interleaved = zipped.flatten(true);\n      if (zipped.size) {\n        interleaved.size = zipped.size * iterables.length;\n      }\n      return reify(this, interleaved);\n    },\n\n    keySeq: function() {\n      return Range(0, this.size);\n    },\n\n    last: function() {\n      return this.get(-1);\n    },\n\n    skipWhile: function(predicate, context) {\n      return reify(this, skipWhileFactory(this, predicate, context, false));\n    },\n\n    zip: function(/*, ...iterables */) {\n      var iterables = [this].concat(arrCopy(arguments));\n      return reify(this, zipWithFactory(this, defaultZipper, iterables));\n    },\n\n    zipWith: function(zipper/*, ...iterables */) {\n      var iterables = arrCopy(arguments);\n      iterables[0] = this;\n      return reify(this, zipWithFactory(this, zipper, iterables));\n    }\n\n  });\n\n  IndexedIterable.prototype[IS_INDEXED_SENTINEL] = true;\n  IndexedIterable.prototype[IS_ORDERED_SENTINEL] = true;\n\n\n\n  mixin(SetIterable, {\n\n    // ### ES6 Collection methods (ES6 Array and Map)\n\n    get: function(value, notSetValue) {\n      return this.has(value) ? value : notSetValue;\n    },\n\n    includes: function(value) {\n      return this.has(value);\n    },\n\n\n    // ### More sequential methods\n\n    keySeq: function() {\n      return this.valueSeq();\n    }\n\n  });\n\n  SetIterable.prototype.has = IterablePrototype.includes;\n  SetIterable.prototype.contains = SetIterable.prototype.includes;\n\n\n  // Mixin subclasses\n\n  mixin(KeyedSeq, KeyedIterable.prototype);\n  mixin(IndexedSeq, IndexedIterable.prototype);\n  mixin(SetSeq, SetIterable.prototype);\n\n  mixin(KeyedCollection, KeyedIterable.prototype);\n  mixin(IndexedCollection, IndexedIterable.prototype);\n  mixin(SetCollection, SetIterable.prototype);\n\n\n  // #pragma Helper functions\n\n  function keyMapper(v, k) {\n    return k;\n  }\n\n  function entryMapper(v, k) {\n    return [k, v];\n  }\n\n  function not(predicate) {\n    return function() {\n      return !predicate.apply(this, arguments);\n    }\n  }\n\n  function neg(predicate) {\n    return function() {\n      return -predicate.apply(this, arguments);\n    }\n  }\n\n  function quoteString(value) {\n    return typeof value === 'string' ? JSON.stringify(value) : String(value);\n  }\n\n  function defaultZipper() {\n    return arrCopy(arguments);\n  }\n\n  function defaultNegComparator(a, b) {\n    return a < b ? 1 : a > b ? -1 : 0;\n  }\n\n  function hashIterable(iterable) {\n    if (iterable.size === Infinity) {\n      return 0;\n    }\n    var ordered = isOrdered(iterable);\n    var keyed = isKeyed(iterable);\n    var h = ordered ? 1 : 0;\n    var size = iterable.__iterate(\n      keyed ?\n        ordered ?\n          function(v, k)  { h = 31 * h + hashMerge(hash(v), hash(k)) | 0; } :\n          function(v, k)  { h = h + hashMerge(hash(v), hash(k)) | 0; } :\n        ordered ?\n          function(v ) { h = 31 * h + hash(v) | 0; } :\n          function(v ) { h = h + hash(v) | 0; }\n    );\n    return murmurHashOfSize(size, h);\n  }\n\n  function murmurHashOfSize(size, h) {\n    h = imul(h, 0xCC9E2D51);\n    h = imul(h << 15 | h >>> -15, 0x1B873593);\n    h = imul(h << 13 | h >>> -13, 5);\n    h = (h + 0xE6546B64 | 0) ^ size;\n    h = imul(h ^ h >>> 16, 0x85EBCA6B);\n    h = imul(h ^ h >>> 13, 0xC2B2AE35);\n    h = smi(h ^ h >>> 16);\n    return h;\n  }\n\n  function hashMerge(a, b) {\n    return a ^ b + 0x9E3779B9 + (a << 6) + (a >> 2) | 0; // int\n  }\n\n  var Immutable = {\n\n    Iterable: Iterable,\n\n    Seq: Seq,\n    Collection: Collection,\n    Map: Map,\n    OrderedMap: OrderedMap,\n    List: List,\n    Stack: Stack,\n    Set: Set,\n    OrderedSet: OrderedSet,\n\n    Record: Record,\n    Range: Range,\n    Repeat: Repeat,\n\n    is: is,\n    fromJS: fromJS\n\n  };\n\n  return Immutable;\n\n}));\n},{}],2:[function(require,module,exports){\n\"use strict\";\nvar Immutable = require(\"immutable\");\nexports.__esModule = true;\nexports[\"default\"] = Immutable.Record({\n    xSpeed: 0,\n    ySpeed: 0\n}, \"MovementComponent\");\n\n},{\"immutable\":1}],3:[function(require,module,exports){\n\"use strict\";\nvar Immutable = require(\"immutable\");\nexports.__esModule = true;\nexports[\"default\"] = Immutable.Record({\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0\n}, \"PositionComponent\");\n\n},{\"immutable\":1}],4:[function(require,module,exports){\n\"use strict\";\nvar Immutable = require(\"immutable\");\nexports.__esModule = true;\nexports[\"default\"] = Immutable.Record({\n    fill: undefined,\n    stroke: undefined,\n    strokeWidth: 1,\n    shape: undefined\n}, \"RenderComponent\");\n\n},{\"immutable\":1}],5:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Immutable = require(\"immutable\");\nvar MetaComponent = (function (_super) {\n    __extends(MetaComponent, _super);\n    function MetaComponent() {\n        _super.apply(this, arguments);\n    }\n    return MetaComponent;\n}(Immutable.Record({ id: 0 })));\nexports.MetaComponent = MetaComponent;\nvar Engine = (function (_super) {\n    __extends(Engine, _super);\n    function Engine() {\n        _super.apply(this, arguments);\n    }\n    Engine.prototype.mkEntity = function (entity) {\n        var newId = (this.id + 1).toString();\n        var newEntity = entity.set(\"meta\", new MetaComponent({ id: newId }));\n        return this.setIn([\"entities\", newId], newEntity)\n            .set(\"id\", Number(newId));\n    };\n    ;\n    Engine.prototype.upEntity = function (entity) {\n        var id = entity.getIn([\"meta\", \"id\"]);\n        return this.setIn([\"entities\", id], entity);\n    };\n    ;\n    Engine.prototype.rmEntity = function (entity) {\n        var id = entity.getIn([\"meta\", \"id\"]);\n        return this.deleteIn([\"entities\", id]);\n    };\n    ;\n    Engine.prototype.pushState = function (state) {\n        return this.set(\"state\", this.state.push(state));\n    };\n    ;\n    Engine.prototype.popState = function () {\n        return this.set(\"state\", this.state.pop());\n    };\n    ;\n    Engine.prototype.run = function (event) {\n        return this.runSystem(this.state.peek(), event);\n    };\n    ;\n    Engine.prototype.runSystem = function (system, event) {\n        return system(this, event);\n    };\n    ;\n    Engine.prototype.runIterator = function (filters, iterator) {\n        return this.runIteratorOn(filters, iterator, this);\n    };\n    Engine.prototype.runIteratorOn = function (filters, iterator, initial) {\n        return this.entities.filter(function (e) {\n            return filters.every(function (f) { return e.get(f) != undefined; });\n        }).reduce(iterator, initial);\n    };\n    ;\n    return Engine;\n}(Immutable.Record({\n    entities: Immutable.Map(),\n    state: Immutable.Stack(),\n    id: 0\n})));\nexports.__esModule = true;\nexports[\"default\"] = Engine;\n\n},{\"immutable\":1}],6:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Immutable = require(\"immutable\");\nfunction normalizeKey(ev) {\n    return ev.keyCode;\n}\nfunction Input(stage, cb) {\n    stage.setAttribute(\"tabindex\", \"1\");\n    stage.addEventListener(\"keydown\", function (ev) {\n        if (!ev.repeat) {\n            cb(new Event({\n                type: EventType.KEY_DOWN,\n                which: normalizeKey(ev)\n            }));\n        }\n    });\n    stage.addEventListener(\"keyup\", function (ev) {\n        cb(new Event({\n            type: EventType.KEY_UP,\n            which: normalizeKey(ev)\n        }));\n    });\n}\nexports.__esModule = true;\nexports[\"default\"] = Input;\n(function (EventType) {\n    EventType[EventType[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n    EventType[EventType[\"KEY_DOWN\"] = 1] = \"KEY_DOWN\";\n    EventType[EventType[\"KEY_UP\"] = 2] = \"KEY_UP\";\n})(exports.EventType || (exports.EventType = {}));\nvar EventType = exports.EventType;\n(function (Keys) {\n    Keys[Keys[\"ARROW_LEFT\"] = 37] = \"ARROW_LEFT\";\n    Keys[Keys[\"ARROW_RIGHT\"] = 39] = \"ARROW_RIGHT\";\n    Keys[Keys[\"ARROW_UP\"] = 38] = \"ARROW_UP\";\n    Keys[Keys[\"ARROW_DOWN\"] = 40] = \"ARROW_DOWN\";\n    Keys[Keys[\"SPACE\"] = 32] = \"SPACE\";\n})(exports.Keys || (exports.Keys = {}));\nvar Keys = exports.Keys;\nvar Event = (function (_super) {\n    __extends(Event, _super);\n    function Event() {\n        _super.apply(this, arguments);\n    }\n    return Event;\n}(Immutable.Record({\n    type: EventType.UNKNOWN,\n    which: \"\"\n})));\nexports.Event = Event;\n\n},{\"immutable\":1}],7:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Immutable = require(\"immutable\");\nfunction Interval(rate, cb) {\n    var start = performance.now();\n    var now = start;\n    var last = start;\n    var interval = setInterval(function () {\n        try {\n            last = now;\n            now = performance.now();\n            cb(new Event({ t: now - start, dt: now - last }));\n        }\n        catch (err) {\n            clearInterval(interval);\n            cb(err);\n        }\n    }, 1000 / rate);\n}\nexports.__esModule = true;\nexports[\"default\"] = Interval;\n;\nvar Event = (function (_super) {\n    __extends(Event, _super);\n    function Event() {\n        _super.apply(this, arguments);\n    }\n    return Event;\n}(Immutable.Record({\n    t: 0,\n    dt: 0\n})));\nexports.Event = Event;\n\n},{\"immutable\":1}],8:[function(require,module,exports){\n\"use strict\";\nvar IO = (function () {\n    function IO(f) {\n        this._f = f;\n    }\n    IO.Put = function (t) {\n        return new IO(function (_get, set, cb) {\n            set(t);\n            cb(t);\n        });\n    };\n    IO.Get = function () {\n        return new IO(function (get, _set, cb) {\n            cb(get());\n        });\n    };\n    IO.Delay = function (n) {\n        return new IO(function (get, _set, cb) {\n            setTimeout(function () { return cb(get()); }, n);\n        });\n    };\n    IO.All = function (ios) {\n        return new IO(function (get, set, cb) {\n            var counter = 0;\n            for (var _i = 0, ios_1 = ios; _i < ios_1.length; _i++) {\n                var io = ios_1[_i];\n                io.run(get, set, function (t) {\n                    if (++counter === ios.length) {\n                        cb(t);\n                    }\n                });\n            }\n        });\n    };\n    IO.prototype.bind = function (f) {\n        var _this = this;\n        return new IO(function (get, set, cb) {\n            _this._f(get, set, function (t) { return f(t).run(get, set, cb); });\n        });\n    };\n    IO.prototype.map = function (f) {\n        var _this = this;\n        return new IO(function (get, set, cb) {\n            _this._f(get, set, function (t) { return cb(f(t)); });\n        });\n    };\n    IO.prototype.run = function (get, set, cb) {\n        this._f(get, set, cb);\n    };\n    return IO;\n}());\nexports.__esModule = true;\nexports[\"default\"] = IO;\n\n},{}],9:[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar Immutable = require(\"immutable\");\nfunction Render(stage, config) {\n    if (config === void 0) { config = {}; }\n    if (typeof stage.getContext !== \"function\") {\n        throw new Error(\"Canvas not supported\");\n    }\n    var buffer = document.createElement(\"canvas\");\n    var stageCtx = stage.getContext(\"2d\");\n    var bufferCtx = buffer.getContext(\"2d\");\n    var _a = resize(stage, buffer, config), height = _a[0], width = _a[1];\n    var timeout;\n    window.addEventListener(\"resize\", function () {\n        if (timeout == undefined) {\n            timeout = setTimeout(function () {\n                timeout = undefined;\n                _a = resize(stage, buffer, config), height = _a[0], width = _a[1];\n                var _a;\n            }, 10);\n        }\n    });\n    return function (cb) {\n        return function (event) {\n            cb(event);\n            cb(new Event({\n                ctx: bufferCtx,\n                width: width,\n                height: height\n            }));\n            stageCtx.drawImage(buffer, 0, 0);\n        };\n    };\n}\nexports.__esModule = true;\nexports[\"default\"] = Render;\nvar Event = (function (_super) {\n    __extends(Event, _super);\n    function Event() {\n        _super.apply(this, arguments);\n    }\n    return Event;\n}(Immutable.Record({\n    ctx: undefined,\n    width: 0,\n    height: 0\n})));\nexports.Event = Event;\nfunction resize(stage, buffer, config) {\n    var height;\n    var width;\n    var stageCtx = stage.getContext(\"2d\");\n    var bufferCtx = buffer.getContext(\"2d\");\n    var scale = 1;\n    if (typeof config.scale === \"number\") {\n        scale = config.scale;\n    }\n    if (typeof config.height === \"number\") {\n        stage.style.height = ((height = config.height) * scale) + \"px\";\n        stage.height = (buffer.height = height) * scale;\n    }\n    else {\n        height = parseInt(window.getComputedStyle(stage).height, 10);\n        buffer.height = Math.floor((stage.height = height) / scale);\n    }\n    if (typeof config.width === \"number\") {\n        stage.style.width = ((width = config.width) * scale) + \"px\";\n        stage.width = (buffer.width = width) * scale;\n    }\n    else {\n        stage.style.width = (width = (3 / 4) * height) + \"px\";\n        buffer.width = Math.floor((stage.width = width) / scale);\n    }\n    if (typeof config.smoothing === \"boolean\") {\n        stageCtx.mozImageSmoothingEnabled = config.smoothing;\n        stageCtx.imageSmoothingEnabled = config.smoothing;\n    }\n    if (typeof config.scale === \"number\") {\n        stageCtx.scale(config.scale, config.scale);\n    }\n    bufferCtx.translate(0.5, 0.5);\n    return [height, width];\n}\n\n},{\"immutable\":1}],10:[function(require,module,exports){\n\"use strict\";\nvar io_1 = require(\"./io\");\nvar Runtime = (function () {\n    function Runtime(initial, f) {\n        var _this = this;\n        this.state = initial;\n        f(function (event) {\n            if (event instanceof Error) {\n                console.error(event);\n            }\n            else {\n                var temp = _this.state.run(event);\n                if (temp instanceof io_1[\"default\"]) {\n                    temp.run(function () { return _this.state; }, function (t) { return _this.state = t; }, function (t) { return _this.state = t; });\n                }\n                else {\n                    _this.state = temp;\n                }\n            }\n        });\n    }\n    return Runtime;\n}());\nexports.__esModule = true;\nexports[\"default\"] = Runtime;\n\n},{\"./io\":8}],11:[function(require,module,exports){\n\"use strict\";\nrequire(\"../poly.d.ts\");\nvar Immutable = require(\"immutable\");\nvar position_component_1 = require(\"../components/position-component\");\nvar movement_component_1 = require(\"../components/movement-component\");\nvar render_component_1 = require(\"../components/render-component\");\nvar shape = new Path2D();\nshape.moveTo(0, 0);\nshape.arc(3, 3, 3, 0, 2 * Math.PI);\nexports.__esModule = true;\nexports[\"default\"] = Immutable.Record({\n    meta: undefined,\n    position: new position_component_1[\"default\"]({ width: 6, height: 6 }),\n    render: new render_component_1[\"default\"]({\n        shape: shape,\n        fill: \"#00b6E4\"\n    }),\n    movement: new movement_component_1[\"default\"]({ ySpeed: -256 })\n}, \"TestEntity\");\n\n},{\"../components/movement-component\":2,\"../components/position-component\":3,\"../components/render-component\":4,\"../poly.d.ts\":14,\"immutable\":1}],12:[function(require,module,exports){\n\"use strict\";\nrequire(\"../poly.d.ts\");\nvar Immutable = require(\"immutable\");\nvar position_component_1 = require(\"../components/position-component\");\nvar movement_component_1 = require(\"../components/movement-component\");\nvar render_component_1 = require(\"../components/render-component\");\nvar shape = new Path2D();\nshape.moveTo(0, 20);\nshape.lineTo(20, 20);\nshape.lineTo(10, 0);\nshape.lineTo(0, 20);\nexports.__esModule = true;\nexports[\"default\"] = Immutable.Record({\n    meta: undefined,\n    position: new position_component_1[\"default\"]({ x: 32, y: 32, width: 32, height: 32 }),\n    render: new render_component_1[\"default\"]({\n        shape: shape,\n        stroke: \"#00b6E4\",\n        strokeWidth: 2\n    }),\n    movement: new movement_component_1[\"default\"]()\n}, \"TestEntity\");\n\n},{\"../components/movement-component\":2,\"../components/position-component\":3,\"../components/render-component\":4,\"../poly.d.ts\":14,\"immutable\":1}],13:[function(require,module,exports){\n\"use strict\";\nvar runtime_1 = require(\"./engine/runtime\");\nvar interval_1 = require(\"./engine/interval\");\nvar render_1 = require(\"./engine/render\");\nvar input_1 = require(\"./engine/input\");\nvar shmup_1 = require(\"./shmup\");\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n    var _runtime = new runtime_1[\"default\"](shmup_1[\"default\"](), function (cb) {\n        var stage = document.getElementById(\"stage\");\n        var renderer = render_1[\"default\"](stage, {\n            width: 208,\n            height: 256,\n            scale: 2,\n            smoothing: false\n        });\n        interval_1[\"default\"](30, renderer(cb));\n        input_1[\"default\"](stage, cb);\n    });\n});\n\n},{\"./engine/input\":6,\"./engine/interval\":7,\"./engine/render\":9,\"./engine/runtime\":10,\"./shmup\":15}],14:[function(require,module,exports){\n\n},{}],15:[function(require,module,exports){\n\"use strict\";\nvar engine_1 = require(\"./engine/engine\");\nvar render_1 = require(\"./engine/render\");\nvar input_1 = require(\"./engine/input\");\nvar interval_1 = require(\"./engine/interval\");\nvar test_entity_1 = require(\"./entities/test-entity\");\nvar background_system_1 = require(\"./systems/background-system\");\nvar render_system_1 = require(\"./systems/render-system\");\nvar input_system_1 = require(\"./systems/input-system\");\nvar shoot_system_1 = require(\"./systems/shoot-system\");\nvar movement_system_1 = require(\"./systems/movement-system\");\nfunction Shmup() {\n    var entity = (new test_entity_1[\"default\"]())\n        .setIn([\"position\", \"x\"], 32)\n        .setIn([\"position\", \"y\"], 32)\n        .setIn([\"position\", \"width\"], 32)\n        .setIn([\"position\", \"height\"], 32);\n    var shmup = (new engine_1[\"default\"]).mkEntity(entity);\n    var id = shmup.get(\"id\").toString();\n    return shmup.pushState(function (engine, event) {\n        if (event instanceof render_1.Event) {\n            background_system_1[\"default\"](event);\n            render_system_1[\"default\"](engine, event);\n        }\n        else if (event instanceof input_1.Event) {\n            var tmp = input_system_1[\"default\"](engine, engine.getIn([\"entities\", id]), event);\n            return shoot_system_1[\"default\"](tmp, tmp.getIn([\"entities\", id]), event);\n        }\n        else if (event instanceof interval_1.Event) {\n            return movement_system_1[\"default\"](engine, event);\n        }\n        return engine;\n    });\n}\nexports.__esModule = true;\nexports[\"default\"] = Shmup;\n\n},{\"./engine/engine\":5,\"./engine/input\":6,\"./engine/interval\":7,\"./engine/render\":9,\"./entities/test-entity\":12,\"./systems/background-system\":16,\"./systems/input-system\":17,\"./systems/movement-system\":18,\"./systems/render-system\":19,\"./systems/shoot-system\":20}],16:[function(require,module,exports){\n\"use strict\";\nfunction RenderSystem(event) {\n    event.ctx.fillStyle = \"#282828\";\n    event.ctx.strokeStyle = \"#005399\";\n    event.ctx.fillRect(0, 0, event.width, event.height);\n    var offset = (event.width % 16) / 2;\n    for (var i = offset; i < event.width; i += 16) {\n        event.ctx.beginPath();\n        event.ctx.moveTo(i, 0);\n        event.ctx.lineTo(i, event.height);\n        event.ctx.stroke();\n    }\n    for (var i = 8; i < event.height; i += 16) {\n        event.ctx.beginPath();\n        event.ctx.moveTo(0, i);\n        event.ctx.lineTo(event.width, i);\n        event.ctx.stroke();\n    }\n}\nexports.__esModule = true;\nexports[\"default\"] = RenderSystem;\n\n},{}],17:[function(require,module,exports){\n\"use strict\";\nvar input_1 = require(\"../engine/input\");\nfunction InputSystem(engine, entity, event) {\n    var coeff = 0;\n    switch (event.type) {\n        case input_1.EventType.KEY_UP:\n            coeff = -1;\n            break;\n        case input_1.EventType.KEY_DOWN:\n            coeff = 1;\n            break;\n        default:\n            break;\n    }\n    var xSpeed = entity.getIn([\"movement\", \"xSpeed\"]);\n    var ySpeed = entity.getIn([\"movement\", \"ySpeed\"]);\n    console.log(event.which);\n    switch (event.which) {\n        case input_1.Keys.ARROW_LEFT:\n            xSpeed += -64 * coeff;\n            break;\n        case input_1.Keys.ARROW_RIGHT:\n            xSpeed += 64 * coeff;\n            break;\n        case input_1.Keys.ARROW_UP:\n            ySpeed += -64 * coeff;\n            break;\n        case input_1.Keys.ARROW_DOWN:\n            ySpeed += 64 * coeff;\n            break;\n        default:\n            break;\n    }\n    return engine.upEntity(entity.setIn([\"movement\", \"xSpeed\"], xSpeed)\n        .setIn([\"movement\", \"ySpeed\"], ySpeed));\n}\nexports.__esModule = true;\nexports[\"default\"] = InputSystem;\n\n},{\"../engine/input\":6}],18:[function(require,module,exports){\n\"use strict\";\nfunction MovementSystem(engine, event) {\n    return engine.runIterator([\"position\", \"movement\"], function (memo, entity) {\n        var xD = entity.getIn([\"movement\", \"xSpeed\"]) * (event.dt / 1000);\n        var yD = entity.getIn([\"movement\", \"ySpeed\"]) * (event.dt / 1000);\n        var x = entity.getIn([\"position\", \"x\"]) + xD;\n        var y = entity.getIn([\"position\", \"y\"]) + yD;\n        return memo.upEntity(entity.setIn([\"position\", \"x\"], x)\n            .setIn([\"position\", \"y\"], y));\n    });\n}\nexports.__esModule = true;\nexports[\"default\"] = MovementSystem;\n\n},{}],19:[function(require,module,exports){\n\"use strict\";\nrequire(\"../poly.d.ts\");\nfunction RenderSystem(engine, event) {\n    engine.runIterator([\"position\", \"render\"], function (memo, entity) {\n        var shape = entity.getIn([\"render\", \"shape\"]);\n        if (!(shape instanceof Path2D)) {\n            shape = new Path2D();\n            shape.moveTo(0, 0);\n            shape.lineTo(entity.getIn([\"position\", \"width\"]), 0);\n            shape.lineTo(entity.getIn([\"position\", \"width\"]), entity.getIn([\"position\", \"height\"]));\n            shape.lineTo(0, entity.getIn([\"position\", \"height\"]));\n            shape.lineTo(0, 0);\n        }\n        event.ctx.save();\n        event.ctx.translate(entity.getIn([\"position\", \"x\"]), entity.getIn([\"position\", \"y\"]));\n        event.ctx.lineWidth = entity.getIn([\"render\", \"strokeWidth\"]);\n        var strokeStyle = entity.getIn([\"render\", \"stroke\"]);\n        if (typeof strokeStyle === \"string\") {\n            event.ctx.strokeStyle = strokeStyle;\n            event.ctx.stroke(shape);\n        }\n        var fillStyle = entity.getIn([\"render\", \"fill\"]);\n        if (typeof fillStyle === \"string\") {\n            event.ctx.fillStyle = fillStyle;\n            event.ctx.fill(shape);\n        }\n        event.ctx.restore();\n        return memo;\n    });\n}\nexports.__esModule = true;\nexports[\"default\"] = RenderSystem;\n\n},{\"../poly.d.ts\":14}],20:[function(require,module,exports){\n\"use strict\";\nvar input_1 = require(\"../engine/input\");\nvar io_1 = require(\"../engine/io\");\nvar bullet_entity_1 = require(\"../entities/bullet-entity\");\nfunction ShootSystem(engine, entity, event) {\n    if (event.type === input_1.EventType.KEY_DOWN &&\n        event.which === input_1.Keys.SPACE) {\n        var bullet = (new bullet_entity_1[\"default\"]())\n            .setIn([\"position\", \"x\"], entity.getIn([\"position\", \"x\"]) + 16)\n            .setIn([\"position\", \"y\"], entity.getIn([\"position\", \"y\"]) + 32);\n        var newEngine_1 = engine.mkEntity(bullet);\n        return io_1[\"default\"].Put(newEngine_1).bind(function () {\n            return io_1[\"default\"].Delay(3000);\n        }).bind(function (engine2) {\n            var id = newEngine_1.get(\"id\").toString();\n            return io_1[\"default\"].Put(engine2.rmEntity(engine2.getIn([\"entities\", id])));\n        });\n    }\n    else {\n        return engine;\n    }\n}\nexports.__esModule = true;\nexports[\"default\"] = ShootSystem;\n\n},{\"../engine/input\":6,\"../engine/io\":8,\"../entities/bullet-entity\":11}]},{},[13]);\n"]}